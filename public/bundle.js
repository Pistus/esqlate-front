var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function o(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(e,t){const n=e.subscribe(t);return n.unsubscribe?()=>n.unsubscribe():n}function l(e){let t;return a(e,e=>t=e)(),t}const c=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);function s(e,t){e.appendChild(t)}function u(e,t,n){e.insertBefore(t,n||null)}function p(e){e.parentNode.removeChild(e)}function d(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function f(e){return document.createElement(e)}function m(e){return document.createTextNode(e)}function h(){return m(" ")}function g(){return m("")}function v(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function w(e){return function(t){return t.preventDefault(),e.call(this,t)}}function $(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function y(e){return""===e?void 0:+e}function S(e,t){t=""+t,e.data!==t&&(e.data=t)}function b(e,t){(null!=t||e.value)&&(e.value=t)}function _(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}function k(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}}let x;function O(e){x=e}function P(){if(!x)throw new Error("Function called outside component initialization");return x}function T(e){P().$$.after_update.push(e)}function C(){const e=P();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const o=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);r.slice().forEach(t=>{t.call(e,o)})}}}const E=[],R=[],D=[],A=[],I=Promise.resolve();let j=!1;function N(e){D.push(e)}function q(e){A.push(e)}function L(){const e=new Set;do{for(;E.length;){const e=E.shift();O(e),F(e.$$)}for(;R.length;)R.pop()();for(let t=0;t<D.length;t+=1){const n=D[t];e.has(n)||(n(),e.add(n))}D.length=0}while(E.length);for(;A.length;)A.pop()();j=!1}function F(e){null!==e.fragment&&(e.update(e.dirty),r(e.before_update),e.fragment&&e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(N))}const U=new Set;let M;function B(){M={r:0,c:[],p:M}}function z(){M.r||r(M.c),M=M.p}function H(e,t){e&&e.i&&(U.delete(e),e.i(t))}function J(e,t,n,r){if(e&&e.o){if(U.has(e))return;U.add(e),M.c.push(()=>{U.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}const V="undefined"!=typeof window?window:global;function Q(e,t,n){c(e.$$.props,t)&&(t=e.$$.props[t]||t,e.$$.bound[t]=n,n(e.$$.ctx[t]))}function W(e){e&&e.c()}function X(e,n,i){const{fragment:a,on_mount:l,on_destroy:c,after_update:s}=e.$$;a&&a.m(n,i),N(()=>{const n=l.map(t).filter(o);c?c.push(...n):r(n),e.$$.on_mount=[]}),s.forEach(N)}function G(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx={})}function K(e,t){e.$$.dirty||(E.push(e),j||(j=!0,I.then(L)),e.$$.dirty=n()),e.$$.dirty[t]=!0}function Y(t,o,i,a,l,c){const s=x;O(t);const u=o.props||{},p=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:l,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(s?s.$$.context:[]),callbacks:n(),dirty:null};let d=!1;var f;p.ctx=i?i(t,u,(e,n,r=n)=>(p.ctx&&l(p.ctx[e],p.ctx[e]=r)&&(p.bound[e]&&p.bound[e](r),d&&K(t,e)),n)):u,p.update(),d=!0,r(p.before_update),p.fragment=!!a&&a(p.ctx),o.target&&(o.hydrate?p.fragment&&p.fragment.l((f=o.target,Array.from(f.childNodes))):p.fragment&&p.fragment.c(),o.intro&&H(t.$$.fragment),X(t,o.target,o.anchor),L()),O(s)}class Z{$destroy(){G(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}const ee=[];var te="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ne(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function re(e,t){return e(t={exports:{}},t.exports),t.exports}var oe=re(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.getStep=function(e){let t=0,n="0.";for(;t++<e;){if(t>=e)return n+"1";n+="0"}return"1"},t.initializeDateTime=function(e){const t=e.value.indexOf("T"),n=e.date?e.date:t>-1?e.value.substring(0,t):"",r=e.time?e.time:t>-1?e.value.substring(t+1):"";return{value:n&&r?n+"T"+r:"",date:n,time:r}},function(e){e.DATE="DATE",e.TIME="TIME"}(n=t.ProcessDateTimeWhich||(t.ProcessDateTimeWhich={})),t.processDateTime=function(e,t){const r=e.value.indexOf("T");let o=e.value.substring(0,r),i=e.value.substring(r+1);return o&&t!=n.DATE||(o=e.date||""),i&&t!=n.TIME||(i=e.time||""),{value:o&&i?o+"T"+i:"",date:o,time:i}},t.getHightlightPositions=function(e,t){return(e||[]).filter(e=>void 0!==e).reduce((e,n)=>e.concat(function(e,n){let r=-1,o=[];for(;!o.some(e=>-1===e);)r=e.indexOf(n,r+1),o.push(r);return o.filter(e=>-1!==e).filter(e=>(0==e||!t[e-1].match(/[a-z0-9_]/))&&(e+n.length>=t.length||!t[e+n.length].match(/[a-z0-9_]/))).map(e=>({begin:e,end:n.length+e}))}(t,""+n)),[])},function(e){e.Field="Field",e.String="String"}(r=t.LineType||(t.LineType={})),t.getHightlightString=function(e,t){const n=e.concat([]).sort((e,t)=>e.begin-t.begin);let o=0;const i=[];return n.forEach(e=>{o>e.begin||(i.push({type:r.String,value:t.substring(o,e.begin)}),i.push({type:r.Field,value:t.substring(e.begin,e.end)}),o=e.end)}),i.push({type:r.String,value:t.substring(o)}),i}});ne(oe);var ie=oe.getStep,ae=oe.initializeDateTime,le=(oe.ProcessDateTimeWhich,oe.processDateTime),ce=oe.getHightlightPositions,se=(oe.LineType,oe.getHightlightString);function ue(t){let n,r,o,i,a=t.link.text+"";return{c(){n=f("a"),r=m(a),$(n,"href",o=t.link.href),$(n,"class",i=t.link.class?t.link.class:"")},m(e,t){u(e,n,t),s(n,r)},p(e,t){e.link&&a!==(a=t.link.text+"")&&S(r,a),e.link&&o!==(o=t.link.href)&&$(n,"href",o),e.link&&i!==(i=t.link.class?t.link.class:"")&&$(n,"class",i)},i:e,o:e,d(e){e&&p(n)}}}function pe(e,t,n){let{link:r}=t;return e.$set=(e=>{"link"in e&&n("link",r=e.link)}),{link:r}}class de extends Z{constructor(e){super(),Y(this,e,pe,ue,i,{link:0})}}function fe(e,t,n,r){this.message=e,this.expected=t,this.found=n,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,fe)}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(fe,Error),fe.buildMessage=function(e,t){var n={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t,n="";for(t=0;t<e.parts.length;t++)n+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+n+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}return"Expected "+function(e){var t,r,o,i=new Array(e.length);for(t=0;t<e.length;t++)i[t]=(o=e[t],n[o.type](o));if(i.sort(),i.length>0){for(t=1,r=1;t<i.length;t++)i[t-1]!==i[t]&&(i[r]=i[t],r++);i.length=r}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+function(e){return e?'"'+o(e)+'"':"end of input"}(t)+" found."};var me={SyntaxError:fe,parse:function(e,t){t=void 0!==t?t:{};var n,r,o,i,a={},l={Statement:H},c=H,s="{",u=F("{",!1),p="}",d=F("}",!1),f=function(e,t){return{function:e&&e.length?e:"noop",variable:t}},m=" ",h=F(" ",!1),g=function(e,t){return[e].concat(t.map(([e,t])=>t))},v=function(e){return e.reduce((e,t)=>e+t,"")},w=function(e){return{type:"VARIABLE",function:"noop",variable:[e]}},$=function(e){return{type:"TEXT",text:e.reduce((e,t)=>e+t,"")}},y="$$",S=F("$$",!1),b=function(){return"$"},_="$",k=F("$",!1),x=/^[^a-z{$]/,O=U([["a","z"],"{","$"],!0,!1),P=function(e){return"$"+e},T=/^[a-z]/,C=U([["a","z"]],!1,!1),E=/^[a-z_]/,R=U([["a","z"],"_"],!1,!1),D=function(e,t){return e+t.reduce((e,t)=>e+t,"")},A=/^[^$]/,I=U(["$"],!0,!1),j=0,N=[{line:1,column:1}],q=0,L=[];if("startRule"in t){if(!(t.startRule in l))throw new Error("Can't start parsing from rule \""+t.startRule+'".');c=l[t.startRule]}function F(e,t){return{type:"literal",text:e,ignoreCase:t}}function U(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function M(t){var n,r=N[t];if(r)return r;for(n=t-1;!N[n];)n--;for(r={line:(r=N[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return N[t]=r,r}function B(e,t){var n=M(e),r=M(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function z(e){j<q||(j>q&&(q=j,L=[]),L.push(e))}function H(){var e,t;if(e=[],(t=J())===a&&(t=V())===a&&(t=Q()),t!==a)for(;t!==a;)e.push(t),(t=J())===a&&(t=V())===a&&(t=Q());else e=a;return e}function J(){var t,n,r,o,i;return t=j,Y()!==a?(123===e.charCodeAt(j)?(n=s,j++):(n=a,z(u)),n!==a?((r=function(){var t,n,r;return t=j,(n=function(){var t,n;if(t=[],T.test(e.charAt(j))?(n=e.charAt(j),j++):(n=a,z(C)),n!==a)for(;n!==a;)t.push(n),T.test(e.charAt(j))?(n=e.charAt(j),j++):(n=a,z(C));else t=a;return t}())!==a?(32===e.charCodeAt(j)?(r=m,j++):(r=a,z(h)),r!==a?(n=v(n),t=n):(j=t,t=a)):(j=t,t=a),t}())===a&&(r=null),r!==a&&(o=function(){var t,n,r,o,i,l;if(t=j,(n=G())!==a){for(r=[],o=j,32===e.charCodeAt(j)?(i=m,j++):(i=a,z(h)),i!==a&&(l=G())!==a?o=i=[i,l]:(j=o,o=a);o!==a;)r.push(o),o=j,32===e.charCodeAt(j)?(i=m,j++):(i=a,z(h)),i!==a&&(l=G())!==a?o=i=[i,l]:(j=o,o=a);r!==a?(n=g(n,r),t=n):(j=t,t=a)}else j=t,t=a;return t}())!==a?(125===e.charCodeAt(j)?(i=p,j++):(i=a,z(d)),i!==a?t=f(r,o):(j=t,t=a)):(j=t,t=a)):(j=t,t=a)):(j=t,t=a),t}function V(){var e,t;return e=j,Y()!==a&&(t=G())!==a?e=w(t):(j=e,e=a),e}function Q(){var e,t;if(e=[],(t=X())===a&&(t=W())===a&&(t=K()),t!==a)for(;t!==a;)e.push(t),(t=X())===a&&(t=W())===a&&(t=K());else e=a;return e!==a&&(e=$(e)),e}function W(){var t;return e.substr(j,2)===y?(t=y,j+=2):(t=a,z(S)),t!==a&&(t=b()),t}function X(){var t,n,r;return t=j,36===e.charCodeAt(j)?(n=_,j++):(n=a,z(k)),n!==a?(x.test(e.charAt(j))?(r=e.charAt(j),j++):(r=a,z(O)),r!==a?t=n=P(r):(j=t,t=a)):(j=t,t=a),t}function G(){var t,n,r,o;if(t=j,T.test(e.charAt(j))?(n=e.charAt(j),j++):(n=a,z(C)),n!==a){for(r=[],E.test(e.charAt(j))?(o=e.charAt(j),j++):(o=a,z(R));o!==a;)r.push(o),E.test(e.charAt(j))?(o=e.charAt(j),j++):(o=a,z(R));r!==a?t=n=D(n,r):(j=t,t=a)}else j=t,t=a;return t}function K(){var t;return A.test(e.charAt(j))?(t=e.charAt(j),j++):(t=a,z(I)),t}function Y(){var t;return 36===e.charCodeAt(j)?(t=_,j++):(t=a,z(k)),t}if((n=c())!==a&&j===e.length)return n;throw n!==a&&j<e.length&&z({type:"end"}),r=L,o=q<e.length?e.charAt(q):null,i=q<e.length?B(q,q+1):B(q,q),new fe(fe.buildMessage(r,o),r,o,i)}},he=re(function(e,t){var n,r=te&&te.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},o=te&&te.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e};function i(e){return me.parse(e)}function a(e){function t(e){for(var t=[],n=0;n<e.length-1;n++)t.push(e[n]);return t}function n(e){if(0===e.length)throw new Error("newlineBreak: list: Empty");return e[e.length-1]}return e.reduce(function(e,i){if("string"!=typeof i)return o(t(e),[n(e).concat([i])]);var a=r(i.split(/[\r\n]/)),l=a[0],c=a.slice(1);return o(t(e),[n(e).concat([l])]).concat(c.map(function(e){return[e]}))},[[]])}function l(e){function t(e){var t=e.replace("\t","    "),n=t.match(/^ +/);return null===n?t:n[0].replace(/ /g," ")+t.substr(n[0].length)}return{tagIdClass:"div.line",inner:e.map(function(e){if("string"==typeof e)return{tagIdClass:"span",inner:t(e),attrs:{}};if("select"===(e=e).type)return{tagIdClass:"select",inner:[],attrs:{name:e.name}};if("string"===e.type)return{tagIdClass:"input",inner:[],attrs:{name:e.name}};if("integer"===e.type)return{tagIdClass:"input",inner:[],attrs:{name:e.name,type:"number"}};if("server"===e.type)return{tagIdClass:"span",inner:"$"+t(e.name),attrs:{}};throw new Error("Unknown parameter type "+e.type)}),attrs:{}}}Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.TEXT="TEXT",e.VARIABLE="VARIABLE"}(n=t.ParsedType||(t.ParsedType={})),t.rawParse=i,t.removeLineBeginningWhitespace=function(e){var t=e.replace(/^\n/,"").match(/^([ \t]*)/);return t?e.split("\n").map(function(e){return 0===e.indexOf(t[1])?e.replace(t[1],""):e}).join("\n"):e},t.normalize=function(e,t){return("string"==typeof t?[t]:t).reduce(function(t,r){return"string"!=typeof r?t.concat(r):i(r).reduce(function(t,r){if(r.type===n.TEXT)return t.concat(r.text);if("noop"!==r.function)throw new Error("The function for a variable must be noop");if(1!==r.variable.length)throw new Error("Only one variable for a ${} is allowed");return t.concat(function(t){var n=e.find(function(e){return e.name===t});if(void 0===n)throw new Error("Statement refers to parameter "+t+" but it does not exist");return n}(r.variable[0]))},t)},[])},t.newlineBreak=a,t.html_line=l,t.html=function(e){return{tagIdClass:"div",attrs:{},inner:a(e).map(l)}},t.forHyper=function e(t,n){return t([n.tagIdClass,n.inner instanceof Array?n.inner.map(function(n){return n instanceof String?n:e(t,n)}):n.inner,n.attrs])}});ne(he);he.ParsedType,he.rawParse,he.removeLineBeginningWhitespace,he.normalize,he.newlineBreak,he.html_line,he.html,he.forHyper;var ge=re(function(e,t){function n(e,t,n){if("string"==typeof e)throw new Error("renderLink: Requires normalizeLink to be called first: "+e);function r(e){return e.map(e=>""+t[e]||"")}function o(e){if("noop"==e.fun)return r(e.namesOfFields)[0];if("popup"==e.fun){const t=r(e.namesOfFields);if(2!=t.length)throw new Error("generation of a popup link requires 2 params");return encodeURIComponent(t[0])+" "+encodeURIComponent(t[1])}throw new Error(`Unknown function '${e.fun}'`)}return e.reduce((e,t)=>"string"==typeof t?e+t:n?e+encodeURIComponent(o(t)):e+o(t),"")}Object.defineProperty(t,"__esModule",{value:!0}),t.urlSearchParamsToArguments=function(e){let t=[];for(let[n,r]of e.entries())t.push({name:n,val:r});return t},t.addControlStoreToEsqlateQueryComponents=function(e,t){const n=new Set(Object.getOwnPropertyNames(e));function r(e){return e.hasOwnProperty("value")?e.value:""}return Object.getOwnPropertyNames(e).reduce((t,n)=>t.concat([{name:n,val:r(e[n])}]),t.filter(({name:e})=>!n.has(e)))},t.getControlStore=function(e,t,n){const r=e.reduce((e,{name:t,val:n})=>(e.set(t,n),e),new Map);function o(e,t){return t.some(t=>t.value==e)?e:t.length?t[0].value:""}return t.reduce(function(e,t){let i="";if(r.has(t.name)&&(i=r.get(t.name)),"select"==t.type){const r=function(e){const t=n.filter(t=>t.parameter.name==e.name);if(0===t.length)return[];const r=t[0].result;if("preview"!=r.status&&"complete"!=r.status)return[];let o=-1,i=-1;return r.fields.forEach((t,n)=>{t.name==e.value_field&&(o=n),t.name==e.display_field&&(i=n)}),-1==o||-1==i?[]:r.rows.map(e=>({display:""+e[i],value:""+e[o]}))}(t);return Object.assign(Object.assign({},e),{[t.name]:{options:r,value:o(i,r)}})}return Object.assign(Object.assign({},e),{[t.name]:{value:i}})},{})},t.serializeValues=function(e){return e.map(e=>{const t=void 0===e.val?"":encodeURIComponent(e.val);return`${encodeURIComponent(e.name)}=${t}`}).join("&")},t.normalizeLink=function(e,t){const n=new Set(e.map(e=>e)),r={noop:1,popup:2};function o(e){return he.rawParse(e).map(e=>{if(e.type==he.ParsedType.TEXT)return e.text;if(r[e.function]!=e.variable.length)throw new Error(`Function ${e.function} takes ${r[e.function]} parameters`);return e.variable.forEach(e=>{if(!n.has(e))throw new Error("Variable ${v} in link template, but not a known variable")}),{namesOfFields:e.variable,fun:e.function}})}return{class:t.hasOwnProperty("class")?t.class:"",text:t.text?o(t.text):o(t.href),href:o(t.href)}},t.asRow=function(e,t,n){const r=n.reduce((e,t)=>Object.assign(Object.assign({},e),{[t.name]:t.val}),{});return t.reduce((t,n,r)=>Object.assign(Object.assign({},t),{[n.name]:e[r]}),r)},t.getLink=function(e,t){return{text:n(e.hasOwnProperty("text")?e.text:e.href,t,!1),href:n(e.href,t,!0),class:e.hasOwnProperty("class")?e.class:""}},t.addBackValuesToControlStore=function(e,t){return e.reduce((e,t)=>{const n=t.name.match(/^_b[a-z]{1,9}([0-9]{1,3})/);return n?Object.assign(Object.assign({},e),{[n[0]]:{value:""+t.val}}):e},t)},t.popBackFromArguments=function(e){const t=function(e){return e.reduce((e,t)=>{const n=t.name.match(/^_burl([0-9]{1,3})/);return n&&parseInt(n[1])>e?parseInt(n[1]):e},-1)}(e);if(t<0)throw new Error("popBackFromArguments: No back links found");return e.reduce((e,n)=>{const r=n.name.match(/^_b([a-z]{0,9})([0-9]{1,3})/);return r&&parseInt(r[2])==t?Object.assign(Object.assign({},e),{[r[1]]:decodeURIComponent(n.val)}):e},{url:"",fld:"",def:"",dis:"",val:""})},t.pushBackToControlStore=function(e,t){const n=Object.getOwnPropertyNames(e).reduce((e,t)=>{const n=t.match(/^_burl([0-9]{1,3})/);return n&&parseInt(n[1])>e?parseInt(n[1]):e},-1);return Object.assign(Object.assign({},e),{["_burl"+(n+1)]:{value:t.url},["_bfld"+(n+1)]:{value:t.fld},["_bdef"+(n+1)]:{value:t.def},["_bdis"+(n+1)]:{value:t.dis},["_bval"+(n+1)]:{value:t.val}})},t.queryComponentsToArguments=function(e,t){const n=new Set(e.filter(e=>"popup"==e.type).map(e=>e.name));return t.map(e=>{const t=void 0===e.val?"":e.val;if(n.has(e.name)){const n=decodeURIComponent((""+t).replace(/ .*/,""));return{name:e.name,value:n}}return{name:e.name,value:t}}).filter(e=>"#"!==e.name.substring(0,1))}});ne(ge);var ve=ge.urlSearchParamsToArguments,we=ge.addControlStoreToEsqlateQueryComponents,$e=(ge.getControlStore,ge.serializeValues),ye=ge.normalizeLink,Se=ge.asRow,be=ge.getLink,_e=(ge.addBackValuesToControlStore,ge.popBackFromArguments),ke=(ge.pushBackToControlStore,ge.queryComponentsToArguments);function xe(e,t,n){var r,o,i,a,l;function c(){var s=Date.now()-a;s<t&&s>=0?r=setTimeout(c,t-s):(r=null,n||(l=e.apply(i,o),i=o=null))}null==t&&(t=100);var s=function(){i=this,o=arguments,a=Date.now();var s=n&&!r;return r||(r=setTimeout(c,t)),s&&(l=e.apply(i,o),i=o=null),l};return s.clear=function(){r&&(clearTimeout(r),r=null)},s.flush=function(){r&&(l=e.apply(i,o),i=o=null,clearTimeout(r),r=null)},s}xe.debounce=xe;var Oe=xe;const{Object:Pe}=V;function Te(e,t,n){const r=Pe.create(e);return r.link=t[n],r}function Ce(e,t,n){const r=Pe.create(e);return r.cell=t[n],r.i=n,r}function Ee(e,t,n){const r=Pe.create(e);return r.row=t[n],r}function Re(e,t,n){const r=Pe.create(e);return r.field=t[n],r}function De(e){let t,n,r,o,i,a,l,c,m,g,v,w=e.result.fields,y=[];for(let t=0;t<w.length;t+=1)y[t]=Ae(Re(e,w,t));let S=(e.definition.row_links&&e.definition.row_links.length||e.inPopup)&&Ie(),b=e.result.rows||[],k=[];for(let t=0;t<b.length;t+=1)k[t]=ze(Ee(e,b,t));const x=e=>J(k[e],1,1,()=>{k[e]=null});function O(e,t){return t.inPopup?Ve:t.result.full_data_set?He:Je}let P=O(0,e),T=P(e);return{c(){t=f("div"),n=f("div"),r=f("div"),o=f("table"),i=f("thead"),a=f("tr");for(let e=0;e<y.length;e+=1)y[e].c();l=h(),S&&S.c(),c=h(),m=f("tbody");for(let e=0;e<k.length;e+=1)k[e].c();g=h(),T.c(),$(o,"class","results-head table table-striped table-hover"),_(o,"padding-bottom","0"),_(o,"margin","0"),$(r,"id","table-holder"),$(r,"class","svelte-u220hq"),$(n,"class","column col-auto"),_(n,"margin","0 auto"),$(t,"class","columns")},m(e,p){u(e,t,p),s(t,n),s(n,r),s(r,o),s(o,i),s(i,a);for(let e=0;e<y.length;e+=1)y[e].m(a,null);s(a,l),S&&S.m(a,null),s(o,c),s(o,m);for(let e=0;e<k.length;e+=1)k[e].m(m,null);s(n,g),T.m(n,null),v=!0},p(e,t){if(e.alignment||e.result){let n;for(w=t.result.fields,n=0;n<w.length;n+=1){const r=Re(t,w,n);y[n]?y[n].p(e,r):(y[n]=Ae(r),y[n].c(),y[n].m(a,l))}for(;n<y.length;n+=1)y[n].d(1);y.length=w.length}if(t.definition.row_links&&t.definition.row_links.length||t.inPopup?S||((S=Ie()).c(),S.m(a,null)):S&&(S.d(1),S=null),e.definition||e.inPopup||e.pick||e.result||e.getLink||e.normalizeLink||e.getFieldnames||e.args||e.asRow||e.alignment||e.getFormatter){let n;for(b=t.result.rows||[],n=0;n<b.length;n+=1){const r=Ee(t,b,n);k[n]?(k[n].p(e,r),H(k[n],1)):(k[n]=ze(r),k[n].c(),H(k[n],1),k[n].m(m,null))}for(B(),n=b.length;n<k.length;n+=1)x(n);z()}P===(P=O(0,t))&&T?T.p(e,t):(T.d(1),(T=P(t))&&(T.c(),T.m(n,null)))},i(e){if(!v){for(let e=0;e<b.length;e+=1)H(k[e]);v=!0}},o(e){k=k.filter(Boolean);for(let e=0;e<k.length;e+=1)J(k[e]);v=!1},d(e){e&&p(t),d(y,e),S&&S.d(),d(k,e),T.d()}}}function Ae(e){let t,n,r,o=e.field.name+"";return{c(){t=f("th"),n=m(o),$(t,"style",r="text-align: "+Xe(e.field)),$(t,"class","svelte-u220hq")},m(e,r){u(e,t,r),s(t,n)},p(e,i){e.result&&o!==(o=i.field.name+"")&&S(n,o),e.result&&r!==(r="text-align: "+Xe(i.field))&&$(t,"style",r)},d(e){e&&p(t)}}}function Ie(e){let t;return{c(){$(t=f("th"),"class","svelte-u220hq")},m(e,n){u(e,t,n)},d(e){e&&p(t)}}}function je(e){let t,n=e.cell+"";return{c(){t=m(n)},m(e,n){u(e,t,n)},p(e,r){e.result&&n!==(n=r.cell+"")&&S(t,n)},d(e){e&&p(t)}}}function Ne(e){let t,n=e.getFormatter(e.result.fields[e.i].type)(e.cell)+"";return{c(){t=m(n)},m(e,n){u(e,t,n)},p(e,r){e.result&&n!==(n=r.getFormatter(r.result.fields[r.i].type)(r.cell)+"")&&S(t,n)},d(e){e&&p(t)}}}function qe(t){let n;return{c(){n=m("NULL")},m(e,t){u(e,n,t)},p:e,d(e){e&&p(n)}}}function Le(e){let t,n,r;function o(e,t){return null===t.cell?qe:((null==n||e.result)&&(n=!!t.getFormatter(t.result.fields[t.i].type)),n?Ne:je)}let i=o(null,e),a=i(e);return{c(){t=f("td"),a.c(),$(t,"style",r="text-align: "+Xe(e.result.fields[e.i]))},m(e,n){u(e,t,n),a.m(t,null)},p(e,n){i===(i=o(e,n))&&a?a.p(e,n):(a.d(1),(a=i(n))&&(a.c(),a.m(t,null))),e.result&&r!==(r="text-align: "+Xe(n.result.fields[n.i]))&&$(t,"style",r)},d(e){e&&p(t),a.d()}}}function Fe(e){let t,n,r,o;const i=[Me,Ue],a=[];function l(e,t){return t.inPopup?0:1}return t=l(0,e),n=a[t]=i[t](e),{c(){n.c(),r=g()},m(e,n){a[t].m(e,n),u(e,r,n),o=!0},p(e,o){let c=t;(t=l(0,o))===c?a[t].p(e,o):(B(),J(a[c],1,1,()=>{a[c]=null}),z(),(n=a[t])||(n=a[t]=i[t](o)).c(),H(n,1),n.m(r.parentNode,r))},i(e){o||(H(n),o=!0)},o(e){J(n),o=!1},d(e){a[t].d(e),e&&p(r)}}}function Ue(e){let t,n,r=e.definition.row_links||[],o=[];for(let t=0;t<r.length;t+=1)o[t]=Be(Te(e,r,t));const i=e=>J(o[e],1,1,()=>{o[e]=null});return{c(){t=f("td");for(let e=0;e<o.length;e+=1)o[e].c();_(t,"text-align","left")},m(e,r){u(e,t,r);for(let e=0;e<o.length;e+=1)o[e].m(t,null);n=!0},p(e,n){if(e.getLink||e.normalizeLink||e.getFieldnames||e.args||e.definition||e.asRow||e.result){let a;for(r=n.definition.row_links||[],a=0;a<r.length;a+=1){const i=Te(n,r,a);o[a]?(o[a].p(e,i),H(o[a],1)):(o[a]=Be(i),o[a].c(),H(o[a],1),o[a].m(t,null))}for(B(),a=r.length;a<o.length;a+=1)i(a);z()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)H(o[e]);n=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)J(o[e]);n=!1},d(e){e&&p(t),d(o,e)}}}function Me(t){let n,r,o;function i(...e){return t.click_handler(t,...e)}return{c(){n=f("td"),(r=f("button")).textContent="Pick",$(r,"class","btn btn-link"),_(n,"text-align","center"),o=v(r,"click",i)},m(e,t){u(e,n,t),s(n,r)},p(e,n){t=n},i:e,o:e,d(e){e&&p(n),o()}}}function Be(e){let t;const n=new de({props:{link:be(ye(e.getFieldnames(e.args),e.link),Se(e.row,e.result.fields,e.args))}});return{c(){W(n.$$.fragment)},m(e,r){X(n,e,r),t=!0},p(e,t){const r={};(e.args||e.definition||e.result)&&(r.link=be(ye(t.getFieldnames(t.args),t.link),Se(t.row,t.result.fields,t.args))),n.$set(r)},i(e){t||(H(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){G(n,e)}}}function ze(e){let t,n,r,o,i=e.row,a=[];for(let t=0;t<i.length;t+=1)a[t]=Le(Ce(e,i,t));let l=(e.definition.row_links&&e.definition.row_links.length||e.inPopup)&&Fe(e);return{c(){t=f("tr");for(let e=0;e<a.length;e+=1)a[e].c();n=h(),l&&l.c(),r=h()},m(e,i){u(e,t,i);for(let e=0;e<a.length;e+=1)a[e].m(t,null);s(t,n),l&&l.m(t,null),s(t,r),o=!0},p(e,o){if(e.alignment||e.result||e.getFormatter){let r;for(i=o.row,r=0;r<i.length;r+=1){const l=Ce(o,i,r);a[r]?a[r].p(e,l):(a[r]=Le(l),a[r].c(),a[r].m(t,n))}for(;r<a.length;r+=1)a[r].d(1);a.length=i.length}o.definition.row_links&&o.definition.row_links.length||o.inPopup?l?(l.p(e,o),H(l,1)):((l=Fe(o)).c(),H(l,1),l.m(t,r)):l&&(B(),J(l,1,1,()=>{l=null}),z())},i(e){o||(H(l),o=!0)},o(e){J(l),o=!1},d(e){e&&p(t),d(a,e),l&&l.d()}}}function He(t){let n,r,o,i,a;return{c(){n=f("div"),r=m("All the results are showing but you can sitill "),(o=f("a")).textContent="download the results",i=m("."),$(o,"href","#show-downloads"),$(n,"class","toast toast-success toast-resultset-warning"),a=v(o,"click",w(t.showDownloads))},m(e,t){u(e,n,t),s(n,r),s(n,o),s(n,i)},p:e,d(e){e&&p(n),a()}}}function Je(t){let n,r,o,i,a;return{c(){n=f("div"),r=m("⚠ Warning: This result set is very large and not all are shown. If you want to see the full results you will have to "),(o=f("a")).textContent="download them",i=m("."),$(o,"href","#show-downloads"),$(n,"class","toast toast-warning toast-resultset-warning"),a=v(o,"click",w(t.showDownloads))},m(e,t){u(e,n,t),s(n,r),s(n,o),s(n,i)},p:e,d(e){e&&p(n),a()}}}function Ve(e){let t,n=!e.result.full_data_set&&Qe();return{c(){n&&n.c(),t=g()},m(e,r){n&&n.m(e,r),u(e,t,r)},p(e,r){r.result.full_data_set?n&&(n.d(1),n=null):n||((n=Qe()).c(),n.m(t.parentNode,t))},d(e){n&&n.d(e),e&&p(t)}}}function Qe(e){let t;return{c(){(t=f("div")).textContent="⚠ The result set is very large and not all results are shown.",$(t,"class","toast toast-warning toast-resultset-warning")},m(e,n){u(e,t,n)},d(e){e&&p(t)}}}function We(e){let t,n,r,o,i,a=e.result&&("complete"==e.result.status||"preview"==e.result.status)&&De(e);return{c(){t=f("div"),n=f("style"),o=h(),a&&a.c(),$(n,"id",r=e.id+"-style"),$(n,"class","svelte-u220hq"),$(t,"id",e.id),$(t,"class","svelte-u220hq")},m(e,r){u(e,t,r),s(t,n),s(t,o),a&&a.m(t,null),i=!0},p(e,n){!n.result||"complete"!=n.result.status&&"preview"!=n.result.status?a&&(B(),J(a,1,1,()=>{a=null}),z()):a?(a.p(e,n),H(a,1)):((a=De(n)).c(),H(a,1),a.m(t,null))},i(e){i||(H(a),i=!0)},o(e){J(a),i=!1},d(e){e&&p(t),a&&a.d()}}}function Xe(e){return e.type.indexOf("text")>-1||e.type.indexOf("char")>-1||e.type.indexOf("date")>-1||e.type.indexOf("time")>-1?"left":"right"}function Ge(e,t,n){let{definition:r}=t,{controls:o}=t,{result:i}=t,{inPopup:a}=t,{pick:l}=t,{showDownloads:c}=t;const s=a?"in-popup-results":"out-popup-results";function u(){const e=function(){const e=document.getElementById(s+"-style").sheet;for(let t=0;t<e.rules.length;t++)e.removeRule(0);return e}(),t=document.getElementById("code-input-area")?document.getElementById("code-input-area").getBoundingClientRect().width:640;e.insertRule(`#table-holder { min-width: ${t}px }`)}const p=new Intl.DateTimeFormat(window.navigator.language,{year:"numeric",month:"2-digit",day:"2-digit"}),d=new Intl.DateTimeFormat(window.navigator.language,{hour:"numeric",minute:"numeric",second:"numeric",year:"numeric",month:"2-digit",day:"2-digit"}),f={date:e=>p.format(new Date(e)),timestamp:e=>d.format(new Date(e)),jsonb:e=>JSON.stringify(e)};let m=[];T(u),window.onresize=Oe(u,200);return e.$set=(e=>{"definition"in e&&n("definition",r=e.definition),"controls"in e&&n("controls",o=e.controls),"result"in e&&n("result",i=e.result),"inPopup"in e&&n("inPopup",a=e.inPopup),"pick"in e&&n("pick",l=e.pick),"showDownloads"in e&&n("showDownloads",c=e.showDownloads)}),e.$$.update=((e={controls:1,result:1})=>{(e.controls||e.result)&&n("args",m=function(e){return Object.getOwnPropertyNames(e||{}).map(t=>({name:t,val:e[t].value}))}(o).concat(function(e){return e&&e.rows&&e.rows.length?e.fields.map((t,n)=>({name:t.name,val:e.rows[0][n]})):[]}(i)))}),{definition:r,controls:o,result:i,inPopup:a,pick:l,showDownloads:c,id:s,getFormatter:function(e){return f.hasOwnProperty(e)?f[e]:null},args:m,getFieldnames:function(e){return e.map(({name:e})=>e).concat(i&&i.fields?(i.fields||[]).map(({name:e})=>e):[])},click_handler:({row:e},t)=>l(e)}}class Ke extends Z{constructor(e){super(),Y(this,e,Ge,We,i,{definition:0,controls:0,result:0,inPopup:0,pick:0,showDownloads:0})}}function Ye(t){let n,o,i,a,l,c,s,d,m,g,w,y;return{c(){n=f("input"),c=h(),s=f("input"),$(n,"data-highlight-fields",o=JSON.stringify(t.parameter.highlight_fields)),$(n,"id",i="input-"+t.parameter.name),$(n,"data-parameter-name",a=t.parameter.name),$(n,"type","date"),n.value=l=ae(t.control).date||"",$(s,"data-highlight-fields",d=JSON.stringify(t.parameter.highlight_fields)),$(s,"id",m="input-"+t.parameter.name+"-time"),$(s,"data-parameter-name",g=t.parameter.name),$(s,"type","time"),s.value=w=ae(t.control).time||"",y=[v(n,"focus",t.onfocus),v(n,"blur",t.onblur),v(n,"change",t.onchangedate),v(s,"focus",t.onfocus),v(s,"blur",t.onblur),v(s,"change",t.onchangetime)]},m(e,t){u(e,n,t),u(e,c,t),u(e,s,t)},p(e,t){e.parameter&&o!==(o=JSON.stringify(t.parameter.highlight_fields))&&$(n,"data-highlight-fields",o),e.parameter&&i!==(i="input-"+t.parameter.name)&&$(n,"id",i),e.parameter&&a!==(a=t.parameter.name)&&$(n,"data-parameter-name",a),e.control&&l!==(l=ae(t.control).date||"")&&(n.value=l),e.parameter&&d!==(d=JSON.stringify(t.parameter.highlight_fields))&&$(s,"data-highlight-fields",d),e.parameter&&m!==(m="input-"+t.parameter.name+"-time")&&$(s,"id",m),e.parameter&&g!==(g=t.parameter.name)&&$(s,"data-parameter-name",g),e.control&&w!==(w=ae(t.control).time||"")&&(s.value=w)},i:e,o:e,d(e){e&&p(n),e&&p(c),e&&p(s),r(y)}}}function Ze(e,t,n){let{parameter:r}=t,{control:o}=t,{onblur:i}=t,{onfocus:a}=t,{onerror:l}=t,{onfix:c}=t;const s=C();function u(){r.empty_string_is_null||(""!=o.value?c(r.name,r.highlight_fields):l(r.name,r.highlight_fields))}return u(),e.$set=(e=>{"parameter"in e&&n("parameter",r=e.parameter),"control"in e&&n("control",o=e.control),"onblur"in e&&n("onblur",i=e.onblur),"onfocus"in e&&n("onfocus",a=e.onfocus),"onerror"in e&&n("onerror",l=e.onerror),"onfix"in e&&n("onfix",c=e.onfix)}),{parameter:r,control:o,onblur:i,onfocus:a,onerror:l,onfix:c,onchangedate:function({target:{value:e}}){try{n("control",o=le({...o,date:e},"DATE")),s("newvalue",{name:r.name,control:o}),u()}catch(e){l(r.name,r.highlight_fields)}},onchangetime:function({target:{value:e}}){try{n("control",o={...le({...o,time:e},"TIME")}),s("newvalue",{name:r.name,control:o}),u()}catch(e){l(r.name,r.highlight_fields)}}}}class et extends Z{constructor(e){super(),Y(this,e,Ze,Ye,i,{parameter:0,control:0,onblur:0,onfocus:0,onerror:0,onfix:0})}}function tt(t){let n,r,o,i,a,l,c,d=nt(t.control.value)+"";return{c(){n=f("strong"),r=f("button"),o=f("div"),i=m(d),a=m(" ⯅"),$(r,"data-parameter-name",l=t.parameter.name),$(r,"class","input-popup"),c=v(r,"click",t.click_handler)},m(e,t){u(e,n,t),s(n,r),s(r,o),s(o,i),s(r,a)},p(e,t){e.control&&d!==(d=nt(t.control.value)+"")&&S(i,d),e.parameter&&l!==(l=t.parameter.name)&&$(r,"data-parameter-name",l)},i:e,o:e,d(e){e&&p(n),c()}}}function nt(e){return decodeURIComponent(e.substr(e.indexOf(" ")+1))}function rt(e,t,n){let{parameter:r}=t,{control:o}=t,{popup:i}=t,{onerror:a}=t,{onfix:l}=t;r.empty_string_is_null||(""!=o.value?l(r.name,r.highlight_fields):a(r.name,r.highlight_fields));return e.$set=(e=>{"parameter"in e&&n("parameter",r=e.parameter),"control"in e&&n("control",o=e.control),"popup"in e&&n("popup",i=e.popup),"onerror"in e&&n("onerror",a=e.onerror),"onfix"in e&&n("onfix",l=e.onfix)}),{parameter:r,control:o,popup:i,onerror:a,onfix:l,click_handler:()=>i(r.name)}}class ot extends Z{constructor(e){super(),Y(this,e,rt,tt,i,{parameter:0,control:0,popup:0,onerror:0,onfix:0})}}function it(e,t,n){const r=Object.create(e);return r.opt=t[n],r}function at(e){let t,n,r=!e.parameter.hasOwnProperty("name"),o=!e.control||!e.control.hasOwnProperty("value"),i=r&&lt(),a=o&&ct(e);return{c(){i&&i.c(),t=h(),a&&a.c(),n=g()},m(e,r){i&&i.m(e,r),u(e,t,r),a&&a.m(e,r),u(e,n,r)},p(e,l){e.parameter&&(r=!l.parameter.hasOwnProperty("name")),r?i||((i=lt()).c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null),e.control&&(o=!l.control||!l.control.hasOwnProperty("value")),o?a?a.p(e,l):((a=ct(l)).c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},d(e){i&&i.d(e),e&&p(t),a&&a.d(e),e&&p(n)}}}function lt(e){let t;return{c(){(t=f("div")).textContent="Parameter should have 'name'",$(t,"class","deverror")},m(e,n){u(e,t,n)},d(e){e&&p(t)}}}function ct(e){let t,n,r,o,i=e.parameter.name+"";return{c(){t=f("div"),n=m("Control for "),r=m(i),o=m(" should exist and have 'value'"),$(t,"class","deverror")},m(e,i){u(e,t,i),s(t,n),s(t,r),s(t,o)},p(e,t){e.parameter&&i!==(i=t.parameter.name+"")&&S(r,i)},d(e){e&&p(t)}}}function st(t){let n,r,o,i=t.parameter.name+"";return{c(){n=f("strong"),r=m("$"),o=m(i)},m(e,t){u(e,n,t),s(n,r),s(n,o)},p(e,t){e.parameter&&i!==(i=t.parameter.name+"")&&S(o,i)},i:e,o:e,d(e){e&&p(n)}}}function ut(t){let n,r,o=t.control.value+"";return{c(){n=f("strong"),r=m(o)},m(e,t){u(e,n,t),s(n,r)},p(e,t){e.control&&o!==(o=t.control.value+"")&&S(r,o)},i:e,o:e,d(e){e&&p(n)}}}function pt(e){let t;const n=new et({props:{onfix:e.onfix,onerror:e.onerror,onfocus:e.onfocus,onblur:e.onblur,control:e.control,parameter:e.parameter}});return n.$on("newvalue",e.newvalue_handler),{c(){W(n.$$.fragment)},m(e,r){X(n,e,r),t=!0},p(e,t){const r={};e.onfix&&(r.onfix=t.onfix),e.onerror&&(r.onerror=t.onerror),e.onfocus&&(r.onfocus=t.onfocus),e.onblur&&(r.onblur=t.onblur),e.control&&(r.control=t.control),e.parameter&&(r.parameter=t.parameter),n.$set(r)},i(e){t||(H(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){G(n,e)}}}function dt(e){let t;const n=new ot({props:{popup:e.popup,onfix:e.onfix,onerror:e.onerror,control:e.control,parameter:e.parameter,"data-parameter-name":e.parameter.name}});return{c(){W(n.$$.fragment)},m(e,r){X(n,e,r),t=!0},p(e,t){const r={};e.popup&&(r.popup=t.popup),e.onfix&&(r.onfix=t.onfix),e.onerror&&(r.onerror=t.onerror),e.control&&(r.control=t.control),e.parameter&&(r.parameter=t.parameter),e.parameter&&(r["data-parameter-name"]=t.parameter.name),n.$set(r)},i(e){t||(H(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){G(n,e)}}}function ft(t){let n;function r(e,t){return t.control.options?St:""+t.control.value!=""?yt:$t}let o=r(0,t),i=o(t);return{c(){i.c(),n=g()},m(e,t){i.m(e,t),u(e,n,t)},p(e,t){o===(o=r(0,t))&&i?i.p(e,t):(i.d(1),(i=o(t))&&(i.c(),i.m(n.parentNode,n)))},i:e,o:e,d(e){i.d(e),e&&p(n)}}}function mt(t){let n,r,o=t.parameter.name+"";return{c(){n=m("$"),r=m(o)},m(e,t){u(e,n,t),u(e,r,t)},p(e,t){e.parameter&&o!==(o=t.parameter.name+"")&&S(r,o)},i:e,o:e,d(e){e&&p(n),e&&p(r)}}}function ht(t){let n,o,i,a,l,c,s,d=!1;function m(){d=!0,t.input_input_handler_3.call(n)}return{c(){$(n=f("input"),"data-highlight-fields",o=JSON.stringify(t.parameter.highlight_fields)),$(n,"id",i="input-"+t.parameter.name),$(n,"step",a=ie(t.parameter.decimal_places)),$(n,"name",l=t.parameter.name),$(n,"type","number"),$(n,"data-parameter-name",c=t.parameter.name),s=[v(n,"input",m),v(n,"focus",t.onfocus),v(n,"blur",t.onblur),v(n,"change",t.validator(t.isDecimalOk))]},m(e,r){u(e,n,r),b(n,t.control.value)},p(e,t){e.parameter&&o!==(o=JSON.stringify(t.parameter.highlight_fields))&&$(n,"data-highlight-fields",o),e.parameter&&i!==(i="input-"+t.parameter.name)&&$(n,"id",i),e.parameter&&a!==(a=ie(t.parameter.decimal_places))&&$(n,"step",a),e.parameter&&l!==(l=t.parameter.name)&&$(n,"name",l),e.parameter&&c!==(c=t.parameter.name)&&$(n,"data-parameter-name",c),!d&&e.control&&b(n,t.control.value),d=!1},i:e,o:e,d(e){e&&p(n),r(s)}}}function gt(t){let n,o,i,a,l,c,s=!1;function d(){s=!0,t.input_input_handler_2.call(n)}return{c(){$(n=f("input"),"data-highlight-fields",o=JSON.stringify(t.parameter.highlight_fields)),$(n,"id",i="input-"+t.parameter.name),$(n,"name",a=t.parameter.name),$(n,"type","number"),$(n,"data-parameter-name",l=t.parameter.name),c=[v(n,"input",d),v(n,"focus",t.onfocus),v(n,"blur",t.onblur),v(n,"change",t.validator(t.isIntegerOk))]},m(e,r){u(e,n,r),b(n,t.control.value)},p(e,t){e.parameter&&o!==(o=JSON.stringify(t.parameter.highlight_fields))&&$(n,"data-highlight-fields",o),e.parameter&&i!==(i="input-"+t.parameter.name)&&$(n,"id",i),e.parameter&&a!==(a=t.parameter.name)&&$(n,"name",a),e.parameter&&l!==(l=t.parameter.name)&&$(n,"data-parameter-name",l),!s&&e.control&&b(n,t.control.value),s=!1},i:e,o:e,d(e){e&&p(n),r(c)}}}function vt(t){let n,o,i,a,l,c;return{c(){$(n=f("input"),"data-highlight-fields",o=JSON.stringify(t.parameter.highlight_fields)),$(n,"id",i="input-"+t.parameter.name),$(n,"name",a=t.parameter.name),$(n,"type","date"),$(n,"data-parameter-name",l=t.parameter.name),c=[v(n,"input",t.input_input_handler_1),v(n,"focus",t.onfocus),v(n,"blur",t.onblur),v(n,"change",t.validator(t.isDateOk))]},m(e,r){u(e,n,r),b(n,t.control.value)},p(e,t){e.parameter&&o!==(o=JSON.stringify(t.parameter.highlight_fields))&&$(n,"data-highlight-fields",o),e.parameter&&i!==(i="input-"+t.parameter.name)&&$(n,"id",i),e.parameter&&a!==(a=t.parameter.name)&&$(n,"name",a),e.parameter&&l!==(l=t.parameter.name)&&$(n,"data-parameter-name",l),e.control&&b(n,t.control.value)},i:e,o:e,d(e){e&&p(n),r(c)}}}function wt(t){let n,o,i,a,l,c;return{c(){$(n=f("input"),"data-highlight-fields",o=JSON.stringify(t.parameter.highlight_fields)),$(n,"id",i="input-"+t.parameter.name),$(n,"name",a=t.parameter.name),$(n,"data-parameter-name",l=t.parameter.name),c=[v(n,"input",t.input_input_handler),v(n,"focus",t.onfocus),v(n,"blur",t.onblur)]},m(e,r){u(e,n,r),b(n,t.control.value)},p(e,t){e.parameter&&o!==(o=JSON.stringify(t.parameter.highlight_fields))&&$(n,"data-highlight-fields",o),e.parameter&&i!==(i="input-"+t.parameter.name)&&$(n,"id",i),e.parameter&&a!==(a=t.parameter.name)&&$(n,"name",a),e.parameter&&l!==(l=t.parameter.name)&&$(n,"data-parameter-name",l),e.control&&n.value!==t.control.value&&b(n,t.control.value)},i:e,o:e,d(e){e&&p(n),r(c)}}}function $t(e){let t,n,r,o=e.parameter.name+"";return{c(){t=f("strong"),n=m("$"),r=m(o)},m(e,o){u(e,t,o),s(t,n),s(t,r)},p(e,t){e.parameter&&o!==(o=t.parameter.name+"")&&S(r,o)},d(e){e&&p(t)}}}function yt(e){let t,n,r=e.control.value+"";return{c(){t=f("strong"),n=m(r)},m(e,r){u(e,t,r),s(t,n)},p(e,t){e.control&&r!==(r=t.control.value+"")&&S(n,r)},d(e){e&&p(t)}}}function St(e){let t,n,o,i,a,l,c,m=e.parameter.empty_string_is_null&&bt(),h=e.control.options,w=[];for(let t=0;t<h.length;t+=1)w[t]=_t(it(e,h,t));return{c(){t=f("select"),m&&m.c(),n=g();for(let e=0;e<w.length;e+=1)w[e].c();$(t,"data-highlight-fields",o=JSON.stringify(e.parameter.highlight_fields)),$(t,"id",i="input-"+e.parameter.name),$(t,"name",a=e.parameter.name),$(t,"data-parameter-name",l=e.parameter.name),void 0===e.control.value&&N(()=>e.select_change_handler.call(t)),c=[v(t,"change",e.select_change_handler),v(t,"focus",e.onfocus),v(t,"blur",e.onblur)]},m(r,o){u(r,t,o),m&&m.m(t,null),s(t,n);for(let e=0;e<w.length;e+=1)w[e].m(t,null);k(t,e.control.value)},p(e,r){if(r.parameter.empty_string_is_null?m||((m=bt()).c(),m.m(t,n)):m&&(m.d(1),m=null),e.control){let n;for(h=r.control.options,n=0;n<h.length;n+=1){const o=it(r,h,n);w[n]?w[n].p(e,o):(w[n]=_t(o),w[n].c(),w[n].m(t,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=h.length}e.parameter&&o!==(o=JSON.stringify(r.parameter.highlight_fields))&&$(t,"data-highlight-fields",o),e.parameter&&i!==(i="input-"+r.parameter.name)&&$(t,"id",i),e.parameter&&a!==(a=r.parameter.name)&&$(t,"name",a),e.parameter&&l!==(l=r.parameter.name)&&$(t,"data-parameter-name",l),e.control&&k(t,r.control.value)},d(e){e&&p(t),m&&m.d(),d(w,e),r(c)}}}function bt(e){let t;return{c(){(t=f("option")).__value="",t.value=t.__value},m(e,n){u(e,t,n)},d(e){e&&p(t)}}}function _t(e){let t,n,r,o=e.opt.display+"";return{c(){t=f("option"),n=m(o),t.__value=r=e.opt.value,t.value=t.__value},m(e,r){u(e,t,r),s(t,n)},p(e,i){e.control&&o!==(o=i.opt.display+"")&&S(n,o),e.control&&r!==(r=i.opt.value)&&(t.__value=r),t.value=t.__value},d(e){e&&p(t)}}}function kt(e){let t,n,r,o,i,a="server"!=e.parameter.type&&at(e);const l=[wt,vt,gt,ht,mt,ft,dt,pt,ut,st],c=[];function s(e,t){return"string"==t.parameter.type?0:"date"==t.parameter.type?1:"integer"==t.parameter.type?2:"decimal"==t.parameter.type?3:"server"==t.parameter.type?4:"select"==t.parameter.type?5:"popup"==t.parameter.type?6:"datetime"==t.parameter.type?7:""+t.control.value!=""?8:9}return n=s(0,e),r=c[n]=l[n](e),{c(){a&&a.c(),t=h(),r.c(),o=g()},m(e,r){a&&a.m(e,r),u(e,t,r),c[n].m(e,r),u(e,o,r),i=!0},p(e,i){"server"!=i.parameter.type?a?a.p(e,i):((a=at(i)).c(),a.m(t.parentNode,t)):a&&(a.d(1),a=null);let u=n;(n=s(0,i))===u?c[n].p(e,i):(B(),J(c[u],1,1,()=>{c[u]=null}),z(),(r=c[n])||(r=c[n]=l[n](i)).c(),H(r,1),r.m(o.parentNode,o))},i(e){i||(H(r),i=!0)},o(e){J(r),i=!1},d(e){a&&a.d(e),e&&p(t),c[n].d(e),e&&p(o)}}}function xt(e,t,n){const r=C();let{parameter:o}=t,{control:i}=t,{popup:a}=t,{onfocus:l}=t,{onblur:c}=t,{onerror:s}=t,{onfix:u}=t;function p(e){return function(){if(!e(i.value))return s(o.name,o.highlight_fields);u(o.name,o.highlight_fields),r("newvalue",{name:o.name,control:i})}}function d(){return!(!o.empty_string_is_null||""!=i.value)||(""+i.value).match(/\d\d\d\d\-\d\d-\d\d/)}function f(){return!(!o.empty_string_is_null||""!=i.value)||""+parseInt(i.value)==i.value}function m(){return!(!o.empty_string_is_null||""!=i.value)||(""+i.value).match(/^-?(0|[1-9]\d*)(\.\d+)?$/)}return"integer"==o.type&&p(f)(),"decimal"==o.type&&p(m)(),"date"==o.type&&p(d)(),e.$set=(e=>{"parameter"in e&&n("parameter",o=e.parameter),"control"in e&&n("control",i=e.control),"popup"in e&&n("popup",a=e.popup),"onfocus"in e&&n("onfocus",l=e.onfocus),"onblur"in e&&n("onblur",c=e.onblur),"onerror"in e&&n("onerror",s=e.onerror),"onfix"in e&&n("onfix",u=e.onfix)}),{parameter:o,control:i,popup:a,onfocus:l,onblur:c,onerror:s,onfix:u,validator:p,isDateOk:d,isIntegerOk:f,isDecimalOk:m,input_input_handler:function(){i.value=this.value,n("control",i)},input_input_handler_1:function(){i.value=this.value,n("control",i)},input_input_handler_2:function(){i.value=y(this.value),n("control",i)},input_input_handler_3:function(){i.value=y(this.value),n("control",i)},select_change_handler:function(){i.value=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n("control",i)},newvalue_handler:function(t){!function(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}(e,t)}}}class Ot extends Z{constructor(e){super(),Y(this,e,xt,kt,i,{parameter:0,control:0,popup:0,onfocus:0,onblur:0,onerror:0,onfix:0})}}function Pt(e,t,n){const r=Object.create(e);return r.part=t[n],r}function Tt(e){let t,n,r,o=e.part.value+"";return{c(){t=f("span"),n=m(o),$(t,"class","field_highlight"),$(t,"data-field",r=e.part.value)},m(e,r){u(e,t,r),s(t,n)},p(e,i){(e.parameters||e.item)&&o!==(o=i.part.value+"")&&S(n,o),(e.parameters||e.item)&&r!==(r=i.part.value)&&$(t,"data-field",r)},d(e){e&&p(t)}}}function Ct(e){let t,n,r=e.part.value+"";return{c(){t=f("span"),n=m(r)},m(e,r){u(e,t,r),s(t,n)},p(e,t){(e.parameters||e.item)&&r!==(r=t.part.value+"")&&S(n,r)},d(e){e&&p(t)}}}function Et(e){let t;function n(e,t){return"String"==t.part.type?Ct:Tt}let r=n(0,e),o=r(e);return{c(){o.c(),t=g()},m(e,n){o.m(e,n),u(e,t,n)},p(e,i){r===(r=n(0,i))&&o?o.p(e,i):(o.d(1),(o=r(i))&&(o.c(),o.m(t.parentNode,t)))},d(e){o.d(e),e&&p(t)}}}function Rt(t){let n,r=Dt(t.parameters,t.item),o=[];for(let e=0;e<r.length;e+=1)o[e]=Et(Pt(t,r,e));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();n=g()},m(e,t){for(let n=0;n<o.length;n+=1)o[n].m(e,t);u(e,n,t)},p(e,t){if(e.getParts||e.parameters||e.item){let i;for(r=Dt(t.parameters,t.item),i=0;i<r.length;i+=1){const a=Pt(t,r,i);o[i]?o[i].p(e,a):(o[i]=Et(a),o[i].c(),o[i].m(n.parentNode,n))}for(;i<o.length;i+=1)o[i].d(1);o.length=r.length}},i:e,o:e,d(e){d(o,e),e&&p(n)}}}function Dt(e,t){const n=Array.from(new Set(e.reduce((e,{name:t,highlight_fields:n})=>e.concat(n||[t]),[])));return se(ce(n,t),t)}function At(e,t,n){let{item:r}=t,{parameters:o}=t;return e.$set=(e=>{"item"in e&&n("item",r=e.item),"parameters"in e&&n("parameters",o=e.parameters)}),{item:r,parameters:o}}class It extends Z{constructor(e){super(),Y(this,e,At,Rt,i,{item:0,parameters:0})}}const{Object:jt}=V;function Nt(e,t,n){const r=jt.create(e);return r.link=t[n],r}function qt(e){let t;const n=new de({props:{link:e.link}});return{c(){W(n.$$.fragment)},m(e,r){X(n,e,r),t=!0},p(e,t){const r={};e.the_links&&(r.link=t.link),n.$set(r)},i(e){t||(H(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){G(n,e)}}}function Lt(e){let t,n,r=e.the_links,o=[];for(let t=0;t<r.length;t+=1)o[t]=qt(Nt(e,r,t));const i=e=>J(o[e],1,1,()=>{o[e]=null});return{c(){t=f("div");for(let e=0;e<o.length;e+=1)o[e].c();$(t,"id","main_links")},m(e,r){u(e,t,r);for(let e=0;e<o.length;e+=1)o[e].m(t,null);n=!0},p(e,n){if(e.the_links){let a;for(r=n.the_links,a=0;a<r.length;a+=1){const i=Nt(n,r,a);o[a]?(o[a].p(e,i),H(o[a],1)):(o[a]=qt(i),o[a].c(),H(o[a],1),o[a].m(t,null))}for(B(),a=r.length;a<o.length;a+=1)i(a);z()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)H(o[e]);n=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)J(o[e]);n=!1},d(e){e&&p(t),d(o,e)}}}function Ft(e,t,n){let{links:r}=t,{controls:o}=t,{result:i}=t,a=[],l=[];return e.$set=(e=>{"links"in e&&n("links",r=e.links),"controls"in e&&n("controls",o=e.controls),"result"in e&&n("result",i=e.result)}),e.$$.update=((e={controls:1,result:1,links:1,args:1})=>{(e.controls||e.result)&&n("args",a=function(e){return Object.getOwnPropertyNames(e||{}).map(t=>({name:t,val:e[t].value}))}(o||{}).concat(function(e){return e&&e.rows&&e.rows.length?e.fields.map((t,n)=>({name:t.name,val:e.rows[0][n]})):[]}(i))),(e.links||e.args)&&n("the_links",l=(r||[]).reduce((e,t)=>{try{return e.concat([be(ye(a.map(({name:e})=>e),t),Se(a.map(({name:e})=>e),[],a))])}catch(t){return e}},[]))}),{links:r,controls:o,result:i,the_links:l}}class Ut extends Z{constructor(e){super(),Y(this,e,Ft,Lt,i,{links:0,controls:0,result:0})}}function Mt(e,t,n){const r=Object.create(e);return r.link=t[n],r}function Bt(e,t,n){const r=Object.create(e);return r.parameter=t[n],r}function zt(e,t,n){const r=Object.create(e);return r.item=t[n],r}function Ht(e,t,n){const r=Object.create(e);return r.line=t[n],r}function Jt(e,t,n){const r=Object.create(e);return r.item=t[n],r}function Vt(e){let t,n,r,o,i,a,l=e.item.title+"";return{c(){t=f("li"),n=f("a"),r=m(l),i=h(),$(n,"href",o="#/"+e.item.name),a=v(n,"click",e.hideSidebar)},m(e,o){u(e,t,o),s(t,n),s(n,r),s(t,i)},p(e,t){e.$viewStore&&l!==(l=t.item.title+"")&&S(r,l),e.$viewStore&&o!==(o="#/"+t.item.name)&&$(n,"href",o)},d(e){e&&p(t),a()}}}function Qt(e){let t,n,o,i,a,l,c,d,y,b,k,x,O,P,T,C,E,R,D,A,I,j,N,q,L,F,U,M,V,Q,W,X,G,K,Y,Z,ee,te,ne,re,oe,ie,ae,le,ce=e.$viewStore.definition.title+"",se=(e.$viewStore.definition.statement_type||"EXECUTE")+"",ue=!e.$viewStore.asPopup&&Xt(e);const pe=[Kt,Gt],de=[];function fe(e,t){return t.$viewStore.showingSql?0:1}L=fe(0,e),F=de[L]=pe[L](e);let me=e.$viewStore.asPopup&&cn(e),he=e.$viewStore.asPopup&&sn(e),ge=e.$viewStore.showingDownload&&un(e),ve=!e.$viewStore.asPopup&&gn(e);return{c(){(t=f("div")).innerHTML='<div class="column col-auto" style="margin: 3rem auto 0 auto"><div class="toast toast-error"><button class="btn btn-clear float-right" onclick="esqlateHideToastError()"></button> \n          <div id="toast-error-wrapper-text" style="padding: 1em">\n            xx\n          </div></div></div>',n=h(),ue&&ue.c(),o=h(),i=f("div"),(a=f("a")).textContent=" ",l=h(),c=f("div"),d=f("div"),y=f("div"),b=f("div"),k=f("div"),x=f("div"),O=f("h3"),P=m(ce),(T=f("div")).innerHTML='<span id="color-finder-error" class="text-error"></span>a<span id="color-finder-warning" class="text-warning">b</span><span id="color-finder-success" class="text-success">c</span>',C=h(),E=f("div"),R=f("label"),D=f("input"),I=m("\n                    SQL"),j=f("i"),N=h(),q=f("div"),F.c(),U=h(),M=f("div"),V=f("div"),Q=f("div"),W=f("div"),me&&me.c(),X=h(),G=f("button"),K=m(se),Z=h(),he&&he.c(),re=h(),ge&&ge.c(),oe=h(),ve&&ve.c(),ie=g(),$(t,"class","columns"),$(t,"id","toast-error-wrapper"),_(t,"display","none"),$(a,"href","#close"),$(a,"class","modal-overlay"),$(a,"aria-label","Close"),$(T,"id","color-finder"),_(T,"display","none"),$(x,"class","column col-9"),$(D,"type","checkbox"),D.checked=A=e.$viewStore.showingSql?"checked":"",$(j,"class","form-icon"),$(R,"class","form-switch"),_(R,"float","right"),$(E,"class","column col-3"),$(k,"class","columns"),$(b,"class","container"),$(y,"class","modal-header"),$(q,"class","modal-body"),_(q,"overflow","unset"),$(G,"class",Y="btn btn-primary "+Sn(e.$viewStore.definition.statement_type)),$(W,"class","column col-12"),$(Q,"class","col-gapless columns"),$(V,"class","container"),$(M,"class","modal-footer"),$(d,"class","column col-auto modal-container code-popup"),_(d,"margin","auto"),$(c,"class","columns"),$(c,"style",ee=e.$viewStore.asPopup?"":"margin-top: 2rem"),$(i,"class",te=e.$viewStore.asPopup?"modal active in-popup":"no-modal"),$(i,"style",ne=e.$viewStore.statement.length?"":"display: none"),le=[v(a,"click",w(e.cancel)),v(D,"click",e.toggleShowingSql),v(G,"click",e.run)]},m(e,r){u(e,t,r),u(e,n,r),ue&&ue.m(e,r),u(e,o,r),u(e,i,r),s(i,a),s(i,l),s(i,c),s(c,d),s(d,y),s(y,b),s(b,k),s(k,x),s(x,O),s(O,P),s(x,T),s(k,C),s(k,E),s(E,R),s(R,D),s(R,I),s(R,j),s(d,N),s(d,q),de[L].m(q,null),s(d,U),s(d,M),s(M,V),s(V,Q),s(Q,W),me&&me.m(W,null),s(W,X),s(W,G),s(G,K),s(d,Z),he&&he.m(d,null),u(e,re,r),ge&&ge.m(e,r),u(e,oe,r),ve&&ve.m(e,r),u(e,ie,r),ae=!0},p(e,t){t.$viewStore.asPopup?ue&&(B(),J(ue,1,1,()=>{ue=null}),z()):ue?(ue.p(e,t),H(ue,1)):((ue=Xt(t)).c(),H(ue,1),ue.m(o.parentNode,o)),ae&&!e.$viewStore||ce===(ce=t.$viewStore.definition.title+"")||S(P,ce),(!ae||e.$viewStore&&A!==(A=t.$viewStore.showingSql?"checked":""))&&(D.checked=A);let n=L;(L=fe(0,t))===n?de[L].p(e,t):(B(),J(de[n],1,1,()=>{de[n]=null}),z(),(F=de[L])||(F=de[L]=pe[L](t)).c(),H(F,1),F.m(q,null)),t.$viewStore.asPopup?me?me.p(e,t):((me=cn(t)).c(),me.m(W,X)):me&&(me.d(1),me=null),ae&&!e.$viewStore||se===(se=(t.$viewStore.definition.statement_type||"EXECUTE")+"")||S(K,se),(!ae||e.$viewStore&&Y!==(Y="btn btn-primary "+Sn(t.$viewStore.definition.statement_type)))&&$(G,"class",Y),t.$viewStore.asPopup?he?(he.p(e,t),H(he,1)):((he=sn(t)).c(),H(he,1),he.m(d,null)):he&&(B(),J(he,1,1,()=>{he=null}),z()),(!ae||e.$viewStore&&ee!==(ee=t.$viewStore.asPopup?"":"margin-top: 2rem"))&&$(c,"style",ee),(!ae||e.$viewStore&&te!==(te=t.$viewStore.asPopup?"modal active in-popup":"no-modal"))&&$(i,"class",te),(!ae||e.$viewStore&&ne!==(ne=t.$viewStore.statement.length?"":"display: none"))&&$(i,"style",ne),t.$viewStore.showingDownload?ge?ge.p(e,t):((ge=un(t)).c(),ge.m(oe.parentNode,oe)):ge&&(ge.d(1),ge=null),t.$viewStore.asPopup?ve&&(B(),J(ve,1,1,()=>{ve=null}),z()):ve?(ve.p(e,t),H(ve,1)):((ve=gn(t)).c(),H(ve,1),ve.m(ie.parentNode,ie))},i(e){ae||(H(ue),H(F),H(he),H(ve),ae=!0)},o(e){J(ue),J(F),J(he),J(ve),ae=!1},d(e){e&&p(t),e&&p(n),ue&&ue.d(e),e&&p(o),e&&p(i),de[L].d(),me&&me.d(),he&&he.d(),e&&p(re),ge&&ge.d(e),e&&p(oe),ve&&ve.d(e),e&&p(ie),r(le)}}}function Wt(t){let n;return{c(){(n=f("div")).innerHTML='<div class="column col-auto" style="margin: 3rem auto 0 auto; max-width: 40%"><h2>Welcome to eSQLate.</h2> \n          <p>This tool enables you to create simple administration panels by writing SQL queries within a simple JSON document.</p></div>',$(n,"class","columns")},m(e,t){u(e,n,t)},p:e,i:e,o:e,d(e){e&&p(n)}}}function Xt(e){let t;const n=new Ut({props:{links:e.$viewStore.definition.top_links,controls:e.$viewStore.controls,result:e.$viewStore.result}});return{c(){W(n.$$.fragment)},m(e,r){X(n,e,r),t=!0},p(e,t){const r={};e.$viewStore&&(r.links=t.$viewStore.definition.top_links),e.$viewStore&&(r.controls=t.$viewStore.controls),e.$viewStore&&(r.result=t.$viewStore.result),n.$set(r)},i(e){t||(H(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){G(n,e)}}}function Gt(e){let t,n,r,o,i,a=e.$viewStore.definition.description&&Yt(e),l=e.$viewStore.definition.parameters.filter(_n(e.$viewStore.controls)),c=[];for(let t=0;t<l.length;t+=1)c[t]=tn(Bt(e,l,t));const m=e=>J(c[e],1,1,()=>{c[e]=null});return{c(){t=f("div"),n=f("div"),a&&a.c(),r=h(),o=f("div");for(let e=0;e<c.length;e+=1)c[e].c();$(n,"class","column-12"),$(n,"id","code-input-area"),$(t,"class","col-gapless columns code-description"),$(o,"class","form-horizontal code-form")},m(e,l){u(e,t,l),s(t,n),a&&a.m(n,null),u(e,r,l),u(e,o,l);for(let e=0;e<c.length;e+=1)c[e].m(o,null);i=!0},p(e,t){if(t.$viewStore.definition.description?a?a.p(e,t):((a=Yt(t)).c(),a.m(n,null)):a&&(a.d(1),a=null),e.$viewStore||e.parameterIsAvailable||e.onfix||e.onerror||e.onfocus||e.onblur||e.popup||e.onnewcontrolvalue){let n;for(l=t.$viewStore.definition.parameters.filter(_n(t.$viewStore.controls)),n=0;n<l.length;n+=1){const r=Bt(t,l,n);c[n]?(c[n].p(e,r),H(c[n],1)):(c[n]=tn(r),c[n].c(),H(c[n],1),c[n].m(o,null))}for(B(),n=l.length;n<c.length;n+=1)m(n);z()}},i(e){if(!i){for(let e=0;e<l.length;e+=1)H(c[e]);i=!0}},o(e){c=c.filter(Boolean);for(let e=0;e<c.length;e+=1)J(c[e]);i=!1},d(e){e&&p(t),a&&a.d(),e&&p(r),e&&p(o),d(c,e)}}}function Kt(e){let t,n,r,o,i,a,l,c=e.$viewStore.definition.description&&nn(e),m=e.$viewStore.statement,g=[];for(let t=0;t<m.length;t+=1)g[t]=ln(Ht(e,m,t));const v=e=>J(g[e],1,1,()=>{g[e]=null});return{c(){t=f("div"),n=f("div"),r=f("div"),c&&c.c(),o=h(),i=f("div"),a=f("div");for(let e=0;e<g.length;e+=1)g[e].c();$(r,"class","column-12"),$(r,"id","code-description-area"),$(n,"class","col-gapless columns"),$(a,"class","code-code column col-12"),$(a,"id","code-input-area"),$(i,"class","col-gapless columns"),$(t,"class","container")},m(e,p){u(e,t,p),s(t,n),s(n,r),c&&c.m(r,null),s(t,o),s(t,i),s(i,a);for(let e=0;e<g.length;e+=1)g[e].m(a,null);l=!0},p(e,t){if(t.$viewStore.definition.description?c?c.p(e,t):((c=nn(t)).c(),c.m(r,null)):c&&(c.d(1),c=null),e.$viewStore||e.onfix||e.onerror||e.onfocus||e.onblur||e.popup||e.onnewcontrolvalue){let n;for(m=t.$viewStore.statement,n=0;n<m.length;n+=1){const r=Ht(t,m,n);g[n]?(g[n].p(e,r),H(g[n],1)):(g[n]=ln(r),g[n].c(),H(g[n],1),g[n].m(a,null))}for(B(),n=m.length;n<g.length;n+=1)v(n);z()}},i(e){if(!l){for(let e=0;e<m.length;e+=1)H(g[e]);l=!0}},o(e){g=g.filter(Boolean);for(let e=0;e<g.length;e+=1)J(g[e]);l=!1},d(e){e&&p(t),c&&c.d(),d(g,e)}}}function Yt(e){let t,n=e.md.render(""+e.$viewStore.definition.description)+"";return{c(){t=f("div")},m(e,r){u(e,t,r),t.innerHTML=n},p(e,r){e.$viewStore&&n!==(n=r.md.render(""+r.$viewStore.definition.description)+"")&&(t.innerHTML=n)},d(e){e&&p(t)}}}function Zt(e){let t,n;function r(t){e.parameter_control_binding_2.call(null,t,e)}let o={onfix:e.onfix,onerror:e.onerror,onfocus:$n,onblur:yn,popup:e.popup,parameter:e.parameter};void 0!==e.$viewStore.controls[e.parameter.name]&&(o.control=e.$viewStore.controls[e.parameter.name]);const i=new Ot({props:o});return R.push(()=>Q(i,"control",r)),i.$on("newvalue",e.onnewcontrolvalue),{c(){W(i.$$.fragment)},m(e,t){X(i,e,t),n=!0},p(n,r){e=r;const o={};n.popup&&(o.popup=e.popup),n.$viewStore&&(o.parameter=e.parameter),t||!n.$viewStore&&!n.parameterIsAvailable||(t=!0,o.control=e.$viewStore.controls[e.parameter.name],q(()=>t=!1)),i.$set(o)},i(e){n||(H(i.$$.fragment,e),n=!0)},o(e){J(i.$$.fragment,e),n=!1},d(e){G(i,e)}}}function en(e){let t,n,r;function o(t){e.parameter_control_binding_1.call(null,t,e)}let i={onfix:e.onfix,onerror:e.onerror,onfocus:$n,onblur:yn,popup:e.popup,parameter:e.parameter};void 0!==e.$viewStore.controls[e.parameter.name]&&(i.control=e.$viewStore.controls[e.parameter.name]);const a=new Ot({props:i});return R.push(()=>Q(a,"control",o)),a.$on("newvalue",e.onnewcontrolvalue),{c(){t=f("label"),W(a.$$.fragment),$(t,"class","form-label")},m(e,n){u(e,t,n),X(a,t,null),r=!0},p(t,r){e=r;const o={};t.popup&&(o.popup=e.popup),t.$viewStore&&(o.parameter=e.parameter),n||!t.$viewStore&&!t.parameterIsAvailable||(n=!0,o.control=e.$viewStore.controls[e.parameter.name],q(()=>n=!1)),a.$set(o)},i(e){r||(H(a.$$.fragment,e),r=!0)},o(e){J(a.$$.fragment,e),r=!1},d(e){e&&p(t),G(a)}}}function tn(e){let t,n,r,o,i,a,l,c,d,g,v,w=e.parameter.name+"";const y=[en,Zt],b=[];function _(e,t){return"static"==t.parameter.type?0:1}return c=_(0,e),d=b[c]=y[c](e),{c(){t=f("div"),n=f("div"),r=f("label"),o=m(w),a=h(),l=f("div"),d.c(),g=h(),$(r,"class","form-label"),$(r,"for",i="input-"+e.parameter.name),$(n,"class","column col-5 col-sm-12"),$(l,"class","column col-7 col-sm-12"),$(t,"class","form-group")},m(e,i){u(e,t,i),s(t,n),s(n,r),s(r,o),s(t,a),s(t,l),b[c].m(l,null),s(t,g),v=!0},p(e,t){v&&!e.$viewStore||w===(w=t.parameter.name+"")||S(o,w),(!v||e.$viewStore&&i!==(i="input-"+t.parameter.name))&&$(r,"for",i);let n=c;(c=_(0,t))===n?b[c].p(e,t):(B(),J(b[n],1,1,()=>{b[n]=null}),z(),(d=b[c])||(d=b[c]=y[c](t)).c(),H(d,1),d.m(l,null))},i(e){v||(H(d),v=!0)},o(e){J(d),v=!1},d(e){e&&p(t),b[c].d()}}}function nn(e){let t,n=e.md.render(""+e.$viewStore.definition.description)+"";return{c(){t=f("div")},m(e,r){u(e,t,r),t.innerHTML=n},p(e,r){e.$viewStore&&n!==(n=r.md.render(""+r.$viewStore.definition.description)+"")&&(t.innerHTML=n)},d(e){e&&p(t)}}}function rn(e){let t,n;function r(t){e.parameter_control_binding.call(null,t,e)}let o={onfix:e.onfix,onerror:e.onerror,onfocus:$n,onblur:yn,popup:e.popup,parameter:e.item};void 0!==e.$viewStore.controls[e.item.name]&&(o.control=e.$viewStore.controls[e.item.name]);const i=new Ot({props:o});return R.push(()=>Q(i,"control",r)),i.$on("newvalue",e.onnewcontrolvalue),{c(){W(i.$$.fragment)},m(e,t){X(i,e,t),n=!0},p(n,r){e=r;const o={};n.popup&&(o.popup=e.popup),n.$viewStore&&(o.parameter=e.item),!t&&n.$viewStore&&(t=!0,o.control=e.$viewStore.controls[e.item.name],q(()=>t=!1)),i.$set(o)},i(e){n||(H(i.$$.fragment,e),n=!0)},o(e){J(i.$$.fragment,e),n=!1},d(e){G(i,e)}}}function on(e){let t;const n=new It({props:{parameters:e.$viewStore.definition.parameters,item:e.item}});return{c(){W(n.$$.fragment)},m(e,r){X(n,e,r),t=!0},p(e,t){const r={};e.$viewStore&&(r.parameters=t.$viewStore.definition.parameters),e.$viewStore&&(r.item=t.item),n.$set(r)},i(e){t||(H(n.$$.fragment,e),t=!0)},o(e){J(n.$$.fragment,e),t=!1},d(e){G(n,e)}}}function an(e){let t,n,r,o;const i=[on,rn],a=[];function l(e,t){return"string"==typeof t.item?0:1}return t=l(0,e),n=a[t]=i[t](e),{c(){n.c(),r=g()},m(e,n){a[t].m(e,n),u(e,r,n),o=!0},p(e,o){let c=t;(t=l(0,o))===c?a[t].p(e,o):(B(),J(a[c],1,1,()=>{a[c]=null}),z(),(n=a[t])||(n=a[t]=i[t](o)).c(),H(n,1),n.m(r.parentNode,r))},i(e){o||(H(n),o=!0)},o(e){J(n),o=!1},d(e){a[t].d(e),e&&p(r)}}}function ln(e){let t,n,r,o=e.line,i=[];for(let t=0;t<o.length;t+=1)i[t]=an(zt(e,o,t));const a=e=>J(i[e],1,1,()=>{i[e]=null});return{c(){t=f("div");for(let e=0;e<i.length;e+=1)i[e].c();n=h(),$(t,"class","line")},m(e,o){u(e,t,o);for(let e=0;e<i.length;e+=1)i[e].m(t,null);s(t,n),r=!0},p(e,r){if(e.$viewStore||e.onfix||e.onerror||e.onfocus||e.onblur||e.popup||e.onnewcontrolvalue){let l;for(o=r.line,l=0;l<o.length;l+=1){const a=zt(r,o,l);i[l]?(i[l].p(e,a),H(i[l],1)):(i[l]=an(a),i[l].c(),H(i[l],1),i[l].m(t,n))}for(B(),l=o.length;l<i.length;l+=1)a(l);z()}},i(e){if(!r){for(let e=0;e<o.length;e+=1)H(i[e]);r=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)J(i[e]);r=!1},d(e){e&&p(t),d(i,e)}}}function cn(t){let n,o,i,a;return{c(){(n=f("button")).textContent="Cancel",o=h(),(i=f("button")).textContent="Select Empty Value",$(n,"class","btn btn-link"),$(i,"class","btn"),a=[v(n,"click",t.cancel),v(i,"click",t.empty)]},m(e,t){u(e,n,t),u(e,o,t),u(e,i,t)},p:e,d(e){e&&p(n),e&&p(o),e&&p(i),r(a)}}}function sn(e){let t,n;const r=new Ke({props:{controls:e.$viewStore.controls,pick:e.pick,inPopup:!0,definition:e.$viewStore.definition,result:e.$viewStore.result}});return{c(){t=f("div"),W(r.$$.fragment),$(t,"class","modal-body")},m(e,o){u(e,t,o),X(r,t,null),n=!0},p(e,t){const n={};e.$viewStore&&(n.controls=t.$viewStore.controls),e.pick&&(n.pick=t.pick),e.$viewStore&&(n.definition=t.$viewStore.definition),e.$viewStore&&(n.result=t.$viewStore.result),r.$set(n)},i(e){n||(H(r.$$.fragment,e),n=!0)},o(e){J(r.$$.fragment,e),n=!1},d(e){e&&p(t),G(r)}}}function un(e){let t,n,o,i,a,l,c,d,m,g,y,S,b,k,x,O,P;function T(e,t){return(null==m||e.$viewStore)&&(m=!!bn(t.$viewStore.result).length),m?dn:pn}let C=T(null,e),E=C(e);function R(e,t){return(null==b||e.$viewStore)&&(b=!!bn(t.$viewStore.result).length),b?mn:fn}let D=R(null,e),A=D(e);return{c(){t=f("div"),(n=f("a")).textContent=" ",o=h(),i=f("div"),a=f("div"),(l=f("a")).textContent=" ",c=h(),d=f("div"),E.c(),g=h(),y=f("div"),S=f("div"),A.c(),k=h(),x=f("div"),(O=f("a")).textContent="Cancel",$(n,"href","#close"),$(n,"class","modal-overlay"),$(n,"aria-label","Close"),$(l,"href","#close"),$(l,"class","btn btn-clear float-right"),$(l,"aria-label","Close"),$(d,"class","modal-title h5"),$(a,"class","modal-header"),$(S,"class","content"),_(S,"min-height","2rem"),$(y,"class","modal-body"),$(O,"href","#close"),$(O,"aria-label","Close"),$(x,"class","modal-footer"),$(i,"class","modal-container"),$(t,"class","modal active"),$(t,"id","modal-id"),P=[v(n,"click",w(e.cancelDownload)),v(l,"click",w(e.cancelDownload)),v(O,"click",w(e.cancelDownload))]},m(e,r){u(e,t,r),s(t,n),s(t,o),s(t,i),s(i,a),s(a,l),s(a,c),s(a,d),E.m(d,null),s(i,g),s(i,y),s(y,S),A.m(S,null),s(i,k),s(i,x),s(x,O)},p(e,t){C!==(C=T(e,t))&&(E.d(1),(E=C(t))&&(E.c(),E.m(d,null))),D===(D=R(e,t))&&A?A.p(e,t):(A.d(1),(A=D(t))&&(A.c(),A.m(S,null)))},d(e){e&&p(t),E.d(),A.d(),r(P)}}}function pn(e){let t;return{c(){t=m("Preparing downloads")},m(e,n){u(e,t,n)},d(e){e&&p(t)}}}function dn(e){let t;return{c(){t=m("Please select a download")},m(e,n){u(e,t,n)},d(e){e&&p(t)}}}function fn(t){let n;return{c(){(n=f("div")).textContent="🕓",_(n,"text-align","center"),_(n,"font-size","144pt")},m(e,t){u(e,n,t)},p:e,d(e){e&&p(n)}}}function mn(e){let t,n=bn(e.$viewStore.result),r=[];for(let t=0;t<n.length;t+=1)r[t]=hn(Mt(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=g()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);u(e,t,n)},p(e,o){if(e.runDownload||e.getDownloads||e.$viewStore){let i;for(n=bn(o.$viewStore.result),i=0;i<n.length;i+=1){const a=Mt(o,n,i);r[i]?r[i].p(e,a):(r[i]=hn(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){d(r,e),e&&p(t)}}}function hn(e){let t,n,r,o=e.link.type+"";return{c(){t=f("a"),n=m(o),$(t,"href","#download"),r=v(t,"click",w(function(){e.runDownload(e.link.type).apply(this,arguments)}))},m(e,r){u(e,t,r),s(t,n)},p(t,r){e=r,t.$viewStore&&o!==(o=e.link.type+"")&&S(n,o)},d(e){e&&p(t),r()}}}function gn(e){let t,n,r,o;const i=new Ut({props:{links:e.$viewStore.definition.links,controls:e.$viewStore.controls,result:e.$viewStore.result}}),a=new Ke({props:{showDownloads:e.showDownloads,controls:e.$viewStore.controls,inPopup:!1,definition:e.$viewStore.definition,result:e.$viewStore.result}});return{c(){W(i.$$.fragment),t=h(),n=f("div"),W(a.$$.fragment),_(n,"margin-top","3em"),$(n,"class",r=e.$viewStore.asPopup?"in-popup":"")},m(e,r){X(i,e,r),u(e,t,r),u(e,n,r),X(a,n,null),o=!0},p(e,t){const l={};e.$viewStore&&(l.links=t.$viewStore.definition.links),e.$viewStore&&(l.controls=t.$viewStore.controls),e.$viewStore&&(l.result=t.$viewStore.result),i.$set(l);const c={};e.showDownloads&&(c.showDownloads=t.showDownloads),e.$viewStore&&(c.controls=t.$viewStore.controls),e.$viewStore&&(c.definition=t.$viewStore.definition),e.$viewStore&&(c.result=t.$viewStore.result),a.$set(c),(!o||e.$viewStore&&r!==(r=t.$viewStore.asPopup?"in-popup":""))&&$(n,"class",r)},i(e){o||(H(i.$$.fragment,e),H(a.$$.fragment,e),o=!0)},o(e){J(i.$$.fragment,e),J(a.$$.fragment,e),o=!1},d(e){G(i,e),e&&p(t),e&&p(n),G(a)}}}function vn(e){let t,n,o,i,a,l,c,m,g,y,S,b,_,k,x,O,P,T,C,E,R,D=e.$viewStore.menu||[],A=[];for(let t=0;t<D.length;t+=1)A[t]=Vt(Jt(e,D,t));const I=[Wt,Qt],j=[];function N(e,t){return t.$viewStore.showingMenu?0:1}return _=N(0,e),k=j[_]=I[_](e),{c(){t=f("div"),(n=f("a")).textContent="☰",o=h(),i=f("div"),(a=f("div")).textContent="eSQLate",l=h(),c=f("ul");for(let e=0;e<A.length;e+=1)A[e].c();g=h(),(y=f("a")).textContent=" ",S=h(),b=f("div"),k.c(),O=h(),P=f("div"),(T=f("div")).textContent="🕓",$(n,"class","off-canvas-toggle btn btn-link"),$(n,"href","#sidebar-id"),$(a,"id","logo"),$(c,"id","menu"),$(i,"id","sidebar-id"),$(i,"class",m=e.sidebarActive||e.$viewStore.showingMenu?"off-canvas-sidebar active":"off-canvas-sidebar"),$(y,"class","off-canvas-overlay"),$(y,"href","#close"),$(b,"class","off-canvas-content"),$(t,"class",x=e.$viewStore.showingMenu?"showing-menu off-canvas":"off-canvas"),$(T,"id","loading-modal-content"),$(P,"class",C=e.$viewStore.loading?"modal active":"modal"),$(P,"id","loading-modal"),R=[v(n,"click",w(e.showSidebar)),v(y,"click",w(e.hideSidebar))]},m(e,r){u(e,t,r),s(t,n),s(t,o),s(t,i),s(i,a),s(i,l),s(i,c);for(let e=0;e<A.length;e+=1)A[e].m(c,null);s(t,g),s(t,y),s(t,S),s(t,b),j[_].m(b,null),u(e,O,r),u(e,P,r),s(P,T),E=!0},p(e,n){if(e.$viewStore||e.hideSidebar){let t;for(D=n.$viewStore.menu||[],t=0;t<D.length;t+=1){const r=Jt(n,D,t);A[t]?A[t].p(e,r):(A[t]=Vt(r),A[t].c(),A[t].m(c,null))}for(;t<A.length;t+=1)A[t].d(1);A.length=D.length}(!E||(e.sidebarActive||e.$viewStore)&&m!==(m=n.sidebarActive||n.$viewStore.showingMenu?"off-canvas-sidebar active":"off-canvas-sidebar"))&&$(i,"class",m);let r=_;(_=N(0,n))===r?j[_].p(e,n):(B(),J(j[r],1,1,()=>{j[r]=null}),z(),(k=j[_])||(k=j[_]=I[_](n)).c(),H(k,1),k.m(b,null)),(!E||e.$viewStore&&x!==(x=n.$viewStore.showingMenu?"showing-menu off-canvas":"off-canvas"))&&$(t,"class",x),(!E||e.$viewStore&&C!==(C=n.$viewStore.loading?"modal active":"modal"))&&$(P,"class",C)},i(e){E||(H(k),E=!0)},o(e){J(k),E=!1},d(e){e&&p(t),d(A,e),j[_].d(),e&&p(O),e&&p(P),r(R)}}}function wn(e){let t=document.getElementById(e);if(!t){const n=document.head||document.getElementsByTagName("head")[0];(t=document.createElement("style")).id=e,n.appendChild(t)}for(;t.sheet.rules.length>0;)t.sheet.removeRule(0);return t.sheet}function $n({target:e}){const t=wn("onblur-onfocus-style");let n=JSON.parse(e&&e.dataset&&e.dataset.highlightFields||"[]");0==n.length&&(n=[e.name]),n.forEach(e=>{t.insertRule(`.field_highlight[data-field="${e}"] { font-weight: bold; color: black; }`)})}function yn({target:e}){wn("onblur-onfocus-style")}function Sn(e){switch(e){case"INSERT":case"DELETE":case"UPDATE":return"btn-error";case"SELECT":return"btn-success"}return""}function bn(e){return e&&e.full_format_urls&&e.full_format_urls.length?e.full_format_urls:[]}function _n(e){return t=>e.hasOwnProperty(t.name)}function kn(t,n,r){let o,i=e,c=()=>(i(),i=a(h,e=>r("$viewStore",o=e)),h);t.$$.on_destroy.push(()=>i());let{pick:s}=n,{run:u}=n,{cancelDownload:p}=n,{cancel:d}=n,{empty:f}=n,{popup:m}=n,{viewStore:h}=n;c();let{download:g}=n,{showDownloads:v}=n,{toggleShowingSql:w}=n,$=new Map;function y(e){if($.has(e))return $.get(e);let t=Array.from(document.querySelectorAll(`#color-finder-${e}`)).reduce((e,t)=>window.getComputedStyle(t).color,null);return null!=t&&$.set(e,t),t}let S=new window.markdownit,b=!1;let _=new Map;function k(){const e=wn("onerror"),t=new Set;for(const[n,r]of _){let o=!1;for(const i of r)t.add(i),o||(e.insertRule(`.input-popup[data-parameter-name="${n}"], input[data-parameter-name="${n}"], select[data-parameter-name="${n}"] { border-color:${y("error")} !important; }`),o=!0)}for(const n of t)e.insertRule(`.field_highlight[data-field="${n}"] { color: ${y("error")} !important; }`)}return T(()=>{l(h).definition&&l(h).definition.title&&(window.document.title=`eSQLate: ${l(h).definition.title}`),l(h).loading?setTimeout(()=>{l(h).loading&&document.getElementById("loading-modal").classList.add("loading-notification")},250):document.getElementById("loading-modal").classList.remove("loading-notification")}),t.$set=(e=>{"pick"in e&&r("pick",s=e.pick),"run"in e&&r("run",u=e.run),"cancelDownload"in e&&r("cancelDownload",p=e.cancelDownload),"cancel"in e&&r("cancel",d=e.cancel),"empty"in e&&r("empty",f=e.empty),"popup"in e&&r("popup",m=e.popup),"viewStore"in e&&c(r("viewStore",h=e.viewStore)),"download"in e&&r("download",g=e.download),"showDownloads"in e&&r("showDownloads",v=e.showDownloads),"toggleShowingSql"in e&&r("toggleShowingSql",w=e.toggleShowingSql)}),{pick:s,run:u,cancelDownload:p,cancel:d,empty:f,popup:m,viewStore:h,download:g,showDownloads:v,toggleShowingSql:w,md:S,sidebarActive:b,showSidebar:function(){r("sidebarActive",b=!0)},hideSidebar:function(){r("sidebarActive",b=!1)},onerror:function(e,t){_.has(e)||_.set(e,new Set),(t||[e]).forEach(t=>{_.get(e).add(t)}),k()},onfix:function(e,t){(t||[e]).forEach(t=>{_.get(e)&&_.get(e).delete(t)}),k()},onnewcontrolvalue:function({detail:{name:e,control:t}}){h.update(n=>({...n,controls:{...n.controls,[e]:{...t}}}))},runDownload:function(e){return()=>g(e)},$viewStore:o,parameter_control_binding:function(e,{item:t}){o.controls[t.name]=e,h.set(o)},parameter_control_binding_1:function(e,{parameter:t}){o.controls[t.name]=e,h.set(o)},parameter_control_binding_2:function(e,{parameter:t}){o.controls[t.name]=e,h.set(o)}}}var xn=re(function(e,t){function n(e,t,n,r,o){var i=n(),a=0,l=!1;return new Promise(function(c,s){function u(){i=n(),l=!0,a+=1;try{r().then(function(e){if(l=!1,e.complete)return t(p),c(e.value)}).catch(function(e){t(p),s(e)})}catch(e){t(p),s(e)}}u();var p=e(function(){l||n()-i>o(a)&&u()},10)})}function r(e,t){return n(setInterval,clearTimeout,function(){return(new Date).getTime()},e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.waitForImpl=n,t.waitFor=r,t.default=r});ne(xn);xn.waitForImpl;var On=xn.waitFor,Pn=re(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getFullUrlFromResponseUrl=function(e,t){try{return new URL(t).href}catch(e){}const n=new URL(e);if("//"==t.substring(0,2))return n.protocol+t;if("/"==t.substring(0,1))return e.replace(/\/$/,"")+t;throw new Error("Cannot handle location "+t)}});ne(Pn);var Tn=Pn.getFullUrlFromResponseUrl,Cn=re(function(e,t){function n(){const e=document.querySelector("body").dataset.apiServer.replace(/\/$/,"");return e.match(/https?:/)?e:Pn.getFullUrlFromResponseUrl(window.location.origin,e)}function r(e,t){if(t.status<200||t.status>=300)throw new Error(`HTTP Request to ${e} returned status code `+`${t.status} but I was expecting something in the `+"200 range");return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getURLSearchParams=function(){return new URLSearchParams(window.location.hash.replace(/.*\?/,""))},t.getApiRoot=n,t.getRequest=function(e){const t=Pn.getFullUrlFromResponseUrl(n(),e);return fetch(t,{mode:"cors",cache:"no-cache",headers:{"x-no-redirect":"1","Content-Type":"application/json"}}).then(r.bind(null,e))},t.postRequest=function(e,t){const o=Pn.getFullUrlFromResponseUrl(n(),e),i={method:"POST",mode:"cors",cache:"no-cache",headers:{"x-no-redirect":"1","Content-Type":"application/json"},body:JSON.stringify(t)};return fetch(o,i).then(r.bind(null,e))},t.errorHandler=function(e){alert(e.message)}});ne(Cn);var En=Cn.getURLSearchParams,Rn=Cn.getApiRoot,Dn=Cn.getRequest,An=Cn.postRequest,In=(Cn.errorHandler,re(function(e,t){var n=te&&te.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function l(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,l)}c((r=r.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.getInitialViewStore=function(){return{showingSql:!0,showingMenu:!1,loading:!1,showingDownload:!1,definition:{description:"",name:"",parameters:[],links:[],row_links:[],statement:"",title:""},statement:[],result:!1,controls:{},asPopup:!1,menu:[]}},t.loadDefinitionHTTP=function(e){return n(this,void 0,void 0,function*(){const t=`/definition/${e}`,n=yield Cn.getRequest(t);return yield n.json()})},t.resultDemandHTTP=function(e){return n(this,void 0,void 0,function*(){const t=`/demand/${e}`;return Cn.postRequest(t,{arguments:[]}).then(e=>e.json())})},t.getInitilizeControls=function(e,t,r){return function(o){return n(this,void 0,void 0,function*(){const n=o.definition,i=n.parameters.filter(e=>"select"==e.type),a=yield Promise.all(i.map(e=>r(e.definition).then(t=>({parameter:e,result:t})))),l=ge.getControlStore(ge.urlSearchParamsToArguments(t()),n.parameters,a),c=he.newlineBreak(he.normalize(n.parameters,"string"==typeof n.statement?he.removeLineBeginningWhitespace(n.statement):n.statement));return e.update(e=>Object.assign(Object.assign({},e),{statement:c,controls:l})),o})}},t.getLoadDefinition=function(e,t){return function(r){return n(this,void 0,void 0,function*(){const n=yield e(r.params.definitionName);return t.update(e=>Object.assign(Object.assign({},e),{showingMenu:!1,definition:n})),Object.assign(Object.assign({},r),{definition:n})})}},t.loadResults=function(e,t,r){return n(this,void 0,void 0,function*(){function o(e){return r.indexOf(e)>-1}return t.result&&o(t.result.status)?Promise.resolve(Object.assign({},t)):xn.waitFor(function(){return n(this,void 0,void 0,function*(){const t=yield e();return o(t.status)?{complete:!0,value:t}:{complete:!1}})},function(e){return 300*e}).then(e=>Object.assign(Object.assign({},t),{result:Object.assign(Object.assign({},t.result),e)}))})}}));ne(In);var jn=In.getInitialViewStore,Nn=In.loadDefinitionHTTP,qn=In.resultDemandHTTP,Ln=In.getInitilizeControls,Fn=In.getLoadDefinition,Un=In.loadResults,Mn=ne(re(function(e,t){var n=te&&te.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(xn);t.default=function(e){var t=new Set,n=new Map,o=new Map;return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var l,c=JSON.stringify(i);return n.has(c)?Promise.resolve(n.get(c)):t.has(c)?r.default((l=c,function(){return t.has(l)?Promise.resolve({complete:!1}):Promise.resolve({complete:!0,value:!0})}),function(e){return 50}).then(function(){if(n.has(c))return Promise.resolve(n.get(c));if(o.has(c))return Promise.reject(o.get(c));throw new Error("Esqlate Cache: WaitFor: Ended without success or error?")}):(t.add(c),e.apply(null,i).then(function(e){return n.set(c,e),t.delete(c),e}).catch(function(e){throw o.set(c,e),e}))}}}));function Bn(e,t){let n=[...t];return function(...t){return new Promise(r=>{let o=0;function i(t){e(t)}!function e(t){if(n.length&&o<n.length){const r=(0,n[o++])(t);return r&&r.then?r.then(e).catch(i):r}return r(t)}(t)})}}var zn=re(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getPopupLinkCreator=function(e){return function(t,n,r){const o=n.name,i=n.parameters.reduce((e,n)=>n.name==t?n:e);if(!i)throw new Error(`Could not find Select(name=${t})`);const a=ge.serializeValues(ge.addControlStoreToEsqlateQueryComponents(r,[])),l=encodeURIComponent(`/${encodeURIComponent(o)}?${a}`),c=ge.addBackValuesToControlStore(ge.urlSearchParamsToArguments(e()),{}),s=ge.pushBackToControlStore(c,{url:l,def:o,fld:i.name,val:i.value_field,dis:i.display_field}),u=ge.serializeValues(ge.addControlStoreToEsqlateQueryComponents(s,[]));return`/${encodeURIComponent(i.definition)}?${u}`}},t.pick=function(e,t,n,r=!1){const o=ge.popBackFromArguments(t);function i(e){return n.reduce((t,n,r)=>n.name==e?r:t,-1)}const a=new URLSearchParams(o.url.replace(/.*\?/,"")),l=ge.urlSearchParamsToArguments(a).filter(e=>e.name!=o.fld).concat([{name:o.fld,val:r?"":function(){const t=i(o.val),n=i(o.dis);if(-1==t)throw new Error(`Return is a field that doesn't exist ${o.val}`);return encodeURIComponent(e[t])+" "+encodeURIComponent(e[n])}()}]),c=ge.serializeValues(ge.addControlStoreToEsqlateQueryComponents({},l));return`/${encodeURIComponent(o.def)}?${c}`}});ne(zn);var Hn=zn.getPopupLinkCreator,Jn=zn.pick;function Vn(e){return Kn.update(e=>({...e,result:!1})),Promise.resolve(e)}function Qn(e){return Kn.update(e=>{return{...e,asPopup:ve(En()).reduce((e,t)=>"_burl0"==t.name||e,!1)}}),Promise.resolve(e)}function Wn(e){console.log(e);let t=e;e.message&&(t=e.message),document.getElementById("loading-modal").classList.remove("active"),esqlateShowToastError(t)}function Xn(e){return Kn.update(e=>({...e,loading:!1})),Promise.resolve(e)}function Gn(e){return Kn.update(e=>({...e,loading:!0})),Promise.resolve(e)}const Kn=function(t,n=e){let r;const o=[];function a(e){if(i(t,e)&&(t=e,r)){const e=!ee.length;for(let e=0;e<o.length;e+=1){const n=o[e];n[1](),ee.push(n,t)}if(e){for(let e=0;e<ee.length;e+=2)ee[e][0](ee[e+1]);ee.length=0}}}return{set:a,update:function(e){a(e(t))},subscribe:function(i,l=e){const c=[i,l];return o.push(c),1===o.length&&(r=n(a)||e),i(t),()=>{const e=o.indexOf(c);-1!==e&&o.splice(e,1),0===o.length&&(r(),r=null)}}}}({...jn(),showingSql:"false"!==window.localStorage.getItem("showingSql")});Dn("/definition").then(e=>e.json()).then(e=>Kn.update(t=>({...t,menu:e})));const Yn=Mn(Nn),Zn=Mn(qn),er=new class extends Z{constructor(e){super(),Y(this,e,kn,vn,i,{pick:0,run:0,cancelDownload:0,cancel:0,empty:0,popup:0,viewStore:0,download:0,showDownloads:0,toggleShowingSql:0})}}({target:document.body,props:{viewStore:Kn,toggleShowingSql:function(){Kn.update(e=>{const t=!e.showingSql;return window.localStorage.setItem("showingSql",t),{...e,showingSql:t}})},run:function(){const e=l(Kn).definition.name,t=$e(we(l(Kn).controls,ve(En()))),n=`/${encodeURIComponent(e)}/request?${t}`;nr.setRoute(n)},popup:function(e){const t=Hn(En)(e,l(Kn).definition,l(Kn).controls);nr.setRoute(t)},pick:function(e){const t=Jn(e,ve(En()),l(Kn).result.fields);nr.setRoute(t)},empty:function(){const e=Jn([],ve(En()),l(Kn).result.fields,!0);nr.setRoute(e)},cancel:function(){nr.setRoute(_e(ve(En())).url)},cancelDownload:function(){nr.setRoute(window.location.hash.replace(/^#\/?([^\/]+)\/((result)|(download))/,"/$1/result"))},showDownloads:function(){nr.setRoute(window.location.hash.replace(/^#\/?([^\/]+)\/((result)|(download))/,"/$1/download"))},download:function(e){const t=l(Kn).result.full_format_urls.filter(t=>t.type==e);if(0==t.length)throw Error(`Mime type ${e} was requested but not found`);window.location=Tn(Rn(),t[0].location)}}});var tr={"/":Bn(Wn,[([e])=>(console.log("ROUTE:","/",window.location),Kn.update(e=>({...e,showingMenu:!0})),Promise.resolve({params:{definitionName:e}}))]),"/:definitionName":Bn(Wn,[Gn,([e])=>(console.log("ROUTE:","/:definitionName",[e],window.location),Promise.resolve({params:{definitionName:e}})),Vn,Qn,Fn(Yn,Kn),Ln(Kn,En,Zn),Vn,Xn]),"/:definitionName/request":Bn(Wn,[Gn,([e])=>(console.log("ROUTE:","/:definitionName/request",[e],window.location),Promise.resolve({params:{definitionName:e}})),Vn,Qn,Fn(Yn,Kn),Ln(Kn,En,Zn),Vn,function(e){const t={arguments:ke(l(Kn).definition.parameters,we(l(Kn).controls,ve(En())))},n=`/request/${e.params.definitionName}`,r=$e(we(l(Kn).controls,t.arguments.map(({name:e,value:t})=>({name:e,val:t}))));return An(n,t).then(e=>e.json()).then(t=>{const n=`/${encodeURIComponent(e.params.definitionName)}/request/${encodeURIComponent(t.location)}?${r}`;return nr.setRoute(n),e})}]),"/:definitionName/request/:requestLocation":Bn(Wn,[Gn,([e,t])=>(console.log("ROUTE:","/:definitionName/request/:requestLocation",[e,t],window.location),Promise.resolve({params:{definitionName:e,requestLocation:decodeURIComponent(t)}})),Vn,Qn,Vn,Fn(Yn,Kn),Ln(Kn,En,Zn),function(e){const t=we(l(Kn).controls,ve(En()));return On(function(){return Dn(e.params.requestLocation).then(e=>e.json()).then(e=>"preview"==e.status||"complete"==e.status?{complete:!0,value:e.location}:{complete:!1})},function(e){return 300*e}).then(n=>{const r=`/${encodeURIComponent(e.params.definitionName)}/result/${encodeURIComponent(n)}?${$e(t)}`;return nr.setRoute(r),e})}]),"/:definitionName/:resultOrDownload/:resultLocation":Bn(Wn,[([e,t,n])=>(console.log("ROUTE:","/:definitionName/result/:resultLocation",[e,n],window.location),"result"==t&&Gn(),Promise.resolve({params:{showingDownload:"download"==t,definitionName:e,resultLocation:decodeURIComponent(n)}})),Qn,Fn(Yn,Kn),Ln(Kn,En,Zn),function(e){const t=e.params.showingDownload?["error","complete"]:["error","complete","preview"];return Kn.update(t=>({...t,showingDownload:e.params.showingDownload})),Un(async function(){const t=await Dn(e.params.resultLocation);return await t.json()},l(Kn),t).then(t=>(Kn.set(t),e))},e=>{const t=l(Kn).result;return t&&t.message&&esqlateShowToastError(t.message),Promise.resolve(e)},Xn])};let nr;return""==window.location.hash&&(window.location.hash="/"),(nr=window.Router(tr)).configure({notfound:e=>{nr.setRoute("/")}}),nr.init(),window.onerror=Wn,er}();
//# sourceMappingURL=bundle.js.map
